mads 2.1.3
Source: title_1.asm
     1 				/***************************************/
     2 				/*  Use MADS http://mads.atari8.info/  */
     3 				/*  Mode: DLI (char mode)              */
     4 				/***************************************/
     5
     6 						org MODUL
     7 						opt h-
     8 1770 FF FF 00 60 AF 65 + 		ins "title_music.rmt"
     9 						opt h+
    10 						
    11 1D26					org MUSICPLAYER
    12 1F40					icl "rmtplayr.a65"
Source: rmtplayr.a65
     1 				;*
     2 				;* Raster Music Tracker, RMT Atari routine version 1.20090108
     3 				;* (c) Radek Sterba, Raster/C.P.U., 2002 - 2009
     4 				;* http://raster.atari.org
     5 				;*
     6 				;* Warnings:
     7 				;*
     8 				;* 1. RMT player routine needs 19 itself reserved bytes in zero page (no accessed
     9 				;*    from any other routines) as well as cca 1KB of memory before the "PLAYER"
    10 				;*    address for frequency tables and functionary variables. It's:
    11 				;*	  a) from PLAYER-$03c0 to PLAYER for stereo RMTplayer
    12 				;*    b) from PLAYER-$0320 to PLAYER for mono RMTplayer
    13 				;*
    14 				;* 2. RMT player routine MUST (!!!) be compiled from the begin of the memory page.
    15 				;*    i.e. "PLAYER" address can be $..00 only!
    16 				;*
    17 				;* 3. Because of RMTplayer provides a lot of effects, it spent a lot of CPU time.
    18 				;*
    19 				;* STEREOMODE	equ 0..3			;0 => compile RMTplayer for 4 tracks mono
    20 				;*									;1 => compile RMTplayer for 8 tracks stereo
    21 				;*									;2 => compile RMTplayer for 4 tracks stereo L1 R2 R3 L4
    22 				;*									;3 => compile RMTplayer for 4 tracks stereo L1 L2 R3 R4
    23 				;*
    24
    25 = 0000			STEREOMODE equ 0
    26
    27 					IFT STEREOMODE==1
    28 				TRACKS		equ 8
    29 					ELS
    30 = 0004			TRACKS		equ 4
    31 					EIF
    32 				;*
    33 = 8000			PLAYER		equ $8000
    34 				;*
    35 				;* RMT FEATures definitions file
    36 				;* For optimizations of RMT player routine to concrete RMT modul only!
    37 1F40				icl "rmt_feat.a65"
Source: rmt_feat.a65
     1 				;* --------BEGIN--------
     2 				;* C:\Users\prezes\Downloads\TENSOR FINAL PAZDZIERNIK.rmt
     3 = 0000			FEAT_SFX		equ 0
     4 = 0000			FEAT_GLOBALVOLUMEFADE	equ 0		;RMTGLOBALVOLUMEFADE variable
     5 = 0000			FEAT_NOSTARTINGSONGLINE	equ 0
     6 = 0001			FEAT_INSTRSPEED		equ 1
     7 = 0000			FEAT_CONSTANTSPEED		equ 0		;(1484 times)
     8 = 0001			FEAT_COMMAND1		equ 1		;(42 times)
     9 = 0000			FEAT_COMMAND2		equ 0		;(0 times)
    10 = 0000			FEAT_COMMAND3		equ 0		;(0 times)
    11 = 0000			FEAT_COMMAND4		equ 0		;(0 times)
    12 = 0001			FEAT_COMMAND5		equ 1		;(5 times)
    13 = 0001			FEAT_COMMAND6		equ 1		;(16 times)
    14 = 0000			FEAT_COMMAND7SETNOTE		equ 0		;(0 times)
    15 = 0000			FEAT_COMMAND7VOLUMEONLY		equ 0		;(0 times)
    16 = 0001			FEAT_PORTAMENTO		equ 1		;(10 times)
    17 = 0001			FEAT_FILTER		equ 1		;(30 times)
    18 = 0001			FEAT_FILTERG0L		equ 1		;(30 times)
    19 = 0001			FEAT_FILTERG1L		equ 1		;(20 times)
    20 = 0000			FEAT_FILTERG0R		equ 0		;(0 times)
    21 = 0000			FEAT_FILTERG1R		equ 0		;(0 times)
    22 = 0000			FEAT_BASS16		equ 0		;(0 times)
    23 = 0000			FEAT_BASS16G1L		equ 0		;(0 times)
    24 = 0000			FEAT_BASS16G3L		equ 0		;(0 times)
    25 = 0000			FEAT_BASS16G1R		equ 0		;(0 times)
    26 = 0000			FEAT_BASS16G3R		equ 0		;(0 times)
    27 = 0000			FEAT_VOLUMEONLYG0L		equ 0		;(0 times)
    28 = 0000			FEAT_VOLUMEONLYG2L		equ 0		;(0 times)
    29 = 0000			FEAT_VOLUMEONLYG3L		equ 0		;(0 times)
    30 = 0000			FEAT_VOLUMEONLYG0R		equ 0		;(0 times)
    31 = 0000			FEAT_VOLUMEONLYG2R		equ 0		;(0 times)
    32 = 0000			FEAT_VOLUMEONLYG3R		equ 0		;(0 times)
    33 = 0001			FEAT_TABLETYPE		equ 1		;(1 times)
    34 = 0000			FEAT_TABLEMODE		equ 0		;(0 times)
    35 = 0001			FEAT_TABLEGO		equ 1		;(1 times)
    36 = 0001			FEAT_AUDCTLMANUALSET		equ 1		;(11 times)
    37 = 0000			FEAT_VOLUMEMIN		equ 0		;(0 times)
    38 = 0001			FEAT_EFFECTVIBRATO		equ 1		;(3 times)
    39 = 0001			FEAT_EFFECTFSHIFT		equ 1		;(1 times)
    40 				;* --------END--------
    38 				;*
    39 				;* RMT ZeroPage addresses
    40 1F40				org 203
    41 00CB			p_tis
    42 00CB			p_instrstable	org *+2
    43 00CD			p_trackslbstable	org *+2
    44 00CF			p_trackshbstable	org *+2
    45 00D1			p_song			org *+2
    46 00D3			ns				org *+2
    47 00D5			nr				org *+2
    48 00D7			nt				org *+2
    49 00D9			reg1			org *+1
    50 00DA			reg2			org *+1
    51 00DB			reg3			org *+1
    52 00DC			tmp				org *+1
    53 					IFT FEAT_COMMAND2
    54 				frqaddcmd2		org *+1
    55 					EIF
    56 					IFT TRACKS>4
    57 					org PLAYER-$400+$40
    58 					ELS
    59 00DD				org PLAYER-$400+$e0
    60 					EIF
    61 7CE0			track_variables
    62 7CE0			trackn_db	org *+TRACKS
    63 7CE4			trackn_hb	org *+TRACKS
    64 7CE8			trackn_idx	org *+TRACKS
    65 7CEC			trackn_pause	org *+TRACKS
    66 7CF0			trackn_note	org *+TRACKS
    67 7CF4			trackn_volume	org *+TRACKS
    68 7CF8			trackn_distor 	org *+TRACKS
    69 7CFC			trackn_shiftfrq	org *+TRACKS
    70 					IFT FEAT_PORTAMENTO
    71 7D00			trackn_portafrqc org *+TRACKS
    72 7D04			trackn_portafrqa org *+TRACKS
    73 7D08			trackn_portaspeed org *+TRACKS
    74 7D0C			trackn_portaspeeda org *+TRACKS
    75 7D10			trackn_portadepth org *+TRACKS
    76 					EIF
    77 7D14			trackn_instrx2	org *+TRACKS
    78 7D18			trackn_instrdb	org *+TRACKS
    79 7D1C			trackn_instrhb	org *+TRACKS
    80 7D20			trackn_instridx	org *+TRACKS
    81 7D24			trackn_instrlen	org *+TRACKS
    82 7D28			trackn_instrlop	org *+TRACKS
    83 7D2C			trackn_instrreachend	org *+TRACKS
    84 7D30			trackn_volumeslidedepth org *+TRACKS
    85 7D34			trackn_volumeslidevalue org *+TRACKS
    86 					IFT FEAT_VOLUMEMIN
    87 				trackn_volumemin		org *+TRACKS
    88 					EIF
    89 = 0001			FEAT_EFFECTS equ FEAT_EFFECTVIBRATO||FEAT_EFFECTFSHIFT
    90 					IFT FEAT_EFFECTS
    91 7D38			trackn_effdelay			org *+TRACKS
    92 					EIF
    93 					IFT FEAT_EFFECTVIBRATO
    94 7D3C			trackn_effvibratoa		org *+TRACKS
    95 					EIF
    96 					IFT FEAT_EFFECTFSHIFT
    97 7D40			trackn_effshift		org *+TRACKS
    98 					EIF
    99 7D44			trackn_tabletypespeed org *+TRACKS
   100 					IFT FEAT_TABLEMODE
   101 				trackn_tablemode	org *+TRACKS
   102 					EIF
   103 7D48			trackn_tablenote	org *+TRACKS
   104 7D4C			trackn_tablea		org *+TRACKS
   105 7D50			trackn_tableend		org *+TRACKS
   106 					IFT FEAT_TABLEGO
   107 7D54			trackn_tablelop		org *+TRACKS
   108 					EIF
   109 7D58			trackn_tablespeeda	org *+TRACKS
   110 					IFT FEAT_FILTER||FEAT_BASS16
   111 7D5C			trackn_command		org *+TRACKS
   112 					EIF
   113 					IFT FEAT_BASS16
   114 				trackn_outnote		org *+TRACKS
   115 					EIF
   116 					IFT FEAT_FILTER
   117 7D60			trackn_filter		org *+TRACKS
   118 					EIF
   119 7D64			trackn_audf	org *+TRACKS
   120 7D68			trackn_audc	org *+TRACKS
   121 					IFT FEAT_AUDCTLMANUALSET
   122 7D6C			trackn_audctl	org *+TRACKS
   123 					EIF
   124 7D70			v_aspeed		org *+1
   125 7D71			track_endvariables
   126 7D71					org PLAYER-$100-$140-$40+2
   127 = 000C			INSTRPAR	equ 12
   128 7D82			tabbeganddistor
   129 7D82-7DBF> 80 00		 dta frqtabpure-frqtab,$00
   130 7D84 80 20		 dta frqtabpure-frqtab,$20
   131 7D86 80 40		 dta frqtabpure-frqtab,$40
   132 7D88 00 C0		 dta frqtabbass1-frqtab,$c0
   133 7D8A 80 80		 dta frqtabpure-frqtab,$80
   134 7D8C 80 A0		 dta frqtabpure-frqtab,$a0
   135 7D8E 00 C0		 dta frqtabbass1-frqtab,$c0
   136 7D90 40 C0		 dta frqtabbass2-frqtab,$c0
   137 						IFT FEAT_EFFECTVIBRATO
   138 7D92 00 01 05 0B		vibtabbeg dta 0,vib1-vib0,vib2-vib0,vib3-vib0
   139 7D96 00			vib0	dta 0
   140 7D97 01 FF FF 01		vib1	dta 1,-1,-1,1
   141 7D9B 01 00 FF FF 00 01	vib2	dta 1,0,-1,-1,0,1
   142 7DA1 01 01 00 FF FF FF + vib3	dta 1,1,0,-1,-1,-1,-1,0,1,1
   143 7DAB			vibtabnext
   144 7DAB 00					dta vib0-vib0+0
   145 7DAC 02 03 04 01				dta vib1-vib0+1,vib1-vib0+2,vib1-vib0+3,vib1-vib0+0
   146 7DB0 06 07 08 09 0A 05			dta vib2-vib0+1,vib2-vib0+2,vib2-vib0+3,vib2-vib0+4,vib2-vib0+5,vib2-vib0+0
   147 7DB6 0C 0D 0E 0F 10 11 + 		dta vib3-vib0+1,vib3-vib0+2,vib3-vib0+3,vib3-vib0+4,vib3-vib0+5,vib3-vib0+6,vib3-vib0+7,vib3-vib0+8,vib3-vib0+9,vib3-vib0+0
   148 						EIF
   149 7DC0					org PLAYER-$100-$140
   150 					IFT FEAT_BASS16
   151 				frqtabbasslo
   152 					dta $F2,$33,$96,$E2,$38,$8C,$00,$6A,$E8,$6A,$EF,$80,$08,$AE,$46,$E6
   153 					dta $95,$41,$F6,$B0,$6E,$30,$F6,$BB,$84,$52,$22,$F4,$C8,$A0,$7A,$55
   154 					dta $34,$14,$F5,$D8,$BD,$A4,$8D,$77,$60,$4E,$38,$27,$15,$06,$F7,$E8
   155 					dta $DB,$CF,$C3,$B8,$AC,$A2,$9A,$90,$88,$7F,$78,$70,$6A,$64,$5E,$00
   156 					EIF
   157 7DC0					org PLAYER-$100-$100
   158 7E00			frqtab
   159 					ERT [<frqtab]!=0	;* frqtab must begin at the memory page bound! (i.e. $..00 address)
   160 7E00			frqtabbass1
   161 7E00-7EBF> BF B6 AA A1 + 	dta $BF,$B6,$AA,$A1,$98,$8F,$89,$80,$F2,$E6,$DA,$CE,$BF,$B6,$AA,$A1
   162 7E10 98 8F 89 80 7A 71 + 	dta $98,$8F,$89,$80,$7A,$71,$6B,$65,$5F,$5C,$56,$50,$4D,$47,$44,$3E
   163 7E20 3C 38 35 32 2F 2D + 	dta $3C,$38,$35,$32,$2F,$2D,$2A,$28,$25,$23,$21,$1F,$1D,$1C,$1A,$18
   164 7E30 17 16 14 13 12 11 + 	dta $17,$16,$14,$13,$12,$11,$10,$0F,$0E,$0D,$0C,$0B,$0A,$09,$08,$07
   165 7E40			frqtabbass2
   166 7E40 FF F1 E4 D8 CA C0 + 	dta $FF,$F1,$E4,$D8,$CA,$C0,$B5,$AB,$A2,$99,$8E,$87,$7F,$79,$73,$70
   167 7E50 66 61 5A 55 52 4B + 	dta $66,$61,$5A,$55,$52,$4B,$48,$43,$3F,$3C,$39,$37,$33,$30,$2D,$2A
   168 7E60 28 25 24 21 1F 1E + 	dta $28,$25,$24,$21,$1F,$1E,$1C,$1B,$19,$17,$16,$15,$13,$12,$11,$10
   169 7E70 0F 0E 0D 0C 0B 0A + 	dta $0F,$0E,$0D,$0C,$0B,$0A,$09,$08,$07,$06,$05,$04,$03,$02,$01,$00
   170 7E80			frqtabpure
   171 7E80 F3 E6 D9 CC C1 B5 + 	dta $F3,$E6,$D9,$CC,$C1,$B5,$AD,$A2,$99,$90,$88,$80,$79,$72,$6C,$66
   172 7E90 60 5B 55 51 4C 48 + 	dta $60,$5B,$55,$51,$4C,$48,$44,$40,$3C,$39,$35,$32,$2F,$2D,$2A,$28
   173 7EA0 25 23 21 1F 1D 1C + 	dta $25,$23,$21,$1F,$1D,$1C,$1A,$18,$17,$16,$14,$13,$12,$11,$10,$0F
   174 7EB0 0E 0D 0C 0B 0A 09 + 	dta $0E,$0D,$0C,$0B,$0A,$09,$08,$07,$06,$05,$04,$03,$02,$01,$00,$00
   175 					IFT FEAT_BASS16
   176 				frqtabbasshi
   177 					dta $0D,$0D,$0C,$0B,$0B,$0A,$0A,$09,$08,$08,$07,$07,$07,$06,$06,$05
   178 					dta $05,$05,$04,$04,$04,$04,$03,$03,$03,$03,$03,$02,$02,$02,$02,$02
   179 					dta $02,$02,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$00,$00
   180 					dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   181 					EIF
   182 7EC0					org PLAYER-$0100
   183 7F00			volumetab
   184 7F00-845E> 00 00 00 00 + 	dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   185 7F10 00 00 00 00 00 00 + 	dta $00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$01,$01
   186 7F20 00 00 00 00 01 01 + 	dta $00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$01,$01,$02,$02,$02,$02
   187 7F30 00 00 00 01 01 01 + 	dta $00,$00,$00,$01,$01,$01,$01,$01,$02,$02,$02,$02,$02,$03,$03,$03
   188 7F40 00 00 01 01 01 01 + 	dta $00,$00,$01,$01,$01,$01,$02,$02,$02,$02,$03,$03,$03,$03,$04,$04
   189 7F50 00 00 01 01 01 02 + 	dta $00,$00,$01,$01,$01,$02,$02,$02,$03,$03,$03,$04,$04,$04,$05,$05
   190 7F60 00 00 01 01 02 02 + 	dta $00,$00,$01,$01,$02,$02,$02,$03,$03,$04,$04,$04,$05,$05,$06,$06
   191 7F70 00 00 01 01 02 02 + 	dta $00,$00,$01,$01,$02,$02,$03,$03,$04,$04,$05,$05,$06,$06,$07,$07
   192 7F80 00 01 01 02 02 03 + 	dta $00,$01,$01,$02,$02,$03,$03,$04,$04,$05,$05,$06,$06,$07,$07,$08
   193 7F90 00 01 01 02 02 03 + 	dta $00,$01,$01,$02,$02,$03,$04,$04,$05,$05,$06,$07,$07,$08,$08,$09
   194 7FA0 00 01 01 02 03 03 + 	dta $00,$01,$01,$02,$03,$03,$04,$05,$05,$06,$07,$07,$08,$09,$09,$0A
   195 7FB0 00 01 01 02 03 04 + 	dta $00,$01,$01,$02,$03,$04,$04,$05,$06,$07,$07,$08,$09,$0A,$0A,$0B
   196 7FC0 00 01 02 02 03 04 + 	dta $00,$01,$02,$02,$03,$04,$05,$06,$06,$07,$08,$09,$0A,$0A,$0B,$0C
   197 7FD0 00 01 02 03 03 04 + 	dta $00,$01,$02,$03,$03,$04,$05,$06,$07,$08,$09,$0A,$0A,$0B,$0C,$0D
   198 7FE0 00 01 02 03 04 05 + 	dta $00,$01,$02,$03,$04,$05,$06,$07,$07,$08,$09,$0A,$0B,$0C,$0D,$0E
   199 7FF0 00 01 02 03 04 05 + 	dta $00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0A,$0B,$0C,$0D,$0E,$0F
   200 8000				org PLAYER
   201 				;*
   202 				;* Set of RMT main vectors:
   203 				;*
   204 8000			RASTERMUSICTRACKER
   205 8000 4C 0F 80			jmp rmt_init
   206 8003 4C D9 81			jmp rmt_play
   207 8006 4C F3 81			jmp rmt_p3
   208 8009 4C 4F 80			jmp rmt_silence
   209 800C 4C 29 84			jmp SetPokey
   210 					IFT FEAT_SFX
   211 					jmp rmt_sfx			;* A=note(0,..,60),X=channel(0,..,3 or 0,..,7),Y=instrument*2(0,2,4,..,126)
   212 					EIF
   213 800F			rmt_init
   214 800F 86 D3			stx ns
   215 8011 84 D4			sty ns+1
   216 					IFT FEAT_NOSTARTINGSONGLINE==0
   217 8013 48				pha
   218 					EIF
   219 					IFT track_endvariables-track_variables>255
   220 					ldy #0
   221 					tya
   222 				ri0	sta track_variables,y
   223 					sta track_endvariables-$100,y
   224 					iny
   225 					bne ri0
   226 					ELS
   227 8014 A0 91			ldy #track_endvariables-track_variables
   228 8016 A9 00			lda #0
   229 8018 99 DF 7C		ri0	sta track_variables-1,y
   230 801B 88				dey
   231 801C D0 FA			bne ri0
   232 					EIF
   233 801E A0 04			ldy #4
   234 8020 B1 D3			lda (ns),y
   235 8022 8D E7 81			sta v_maxtracklen
   236 8025 C8				iny
   237 					IFT FEAT_CONSTANTSPEED==0
   238 8026 B1 D3			lda (ns),y
   239 8028 8D B5 80			sta v_speed
   240 					EIF
   241 					IFT FEAT_INSTRSPEED==0
   242 					iny
   243 					lda (ns),y
   244 					sta v_instrspeed
   245 					sta v_ainstrspeed
   246 					ELI FEAT_INSTRSPEED>1
   247 					lda #FEAT_INSTRSPEED
   248 					sta v_ainstrspeed
   249 					EIF
   250 802B A0 08			ldy #8
   251 802D B1 D3		ri1	lda (ns),y
   252 802F 99 C3 00			sta p_tis-8,y
   253 8032 C8				iny
   254 8033 C0 10			cpy #8+8
   255 8035 D0 F6			bne ri1
   256 					IFT FEAT_NOSTARTINGSONGLINE==0
   257 8037 68				pla
   258 8038 48				pha
   259 					IFT TRACKS>4
   260 					asl @
   261 					asl @
   262 					asl @
   263 					clc
   264 					adc p_song
   265 					sta p_song
   266 					pla
   267 					php
   268 					and #$e0
   269 					asl @
   270 					rol @
   271 					rol @
   272 					rol @
   273 					ELS
   274 8039 0A				asl @
   275 803A 0A				asl @
   276 803B 18				clc
   277 803C 65 D1			adc p_song
   278 803E 85 D1			sta p_song
   279 8040 68				pla
   280 8041 08				php
   281 8042 29 C0			and #$c0
   282 8044 0A				asl @
   283 8045 2A				rol @
   284 8046 2A				rol @
   285 					EIF
   286 8047 28				plp
   287 8048 65 D2			adc p_song+1
   288 804A 85 D2			sta p_song+1
   289 					EIF
   290 804C 20 64 80			jsr GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   291 804F			rmt_silence
   292 					IFT STEREOMODE>0
   293 					lda #0
   294 					sta $d208
   295 					sta $d218
   296 					ldy #3
   297 					sty $d20f
   298 					sty $d21f
   299 					ldy #8
   300 				si1	sta $d200,y
   301 					sta $d210,y
   302 					dey
   303 					bpl si1
   304 					ELS
   305 804F A9 00			lda #0
   306 8051 8D 08 D2			sta $d208
   307 8054 A0 03			ldy #3
   308 8056 8C 0F D2			sty $d20f
   309 8059 A0 08			ldy #8
   310 805B 99 00 D2		si1	sta $d200,y
   311 805E 88				dey
   312 805F 10 FA			bpl si1
   313 					EIF
   314 					IFT FEAT_INSTRSPEED==0
   315 					lda v_instrspeed
   316 					ELS
   317 8061 A9 01			lda #FEAT_INSTRSPEED
   318 					EIF
   319 8063 60				rts
   320 8064			GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   321 8064			GetSongLine
   322 8064 A2 00			ldx #0
   323 8066 8E E5 81			stx v_abeat
   324 8069			nn0
   325 8069 8A			nn1	txa
   326 806A A8				tay
   327 806B B1 D1			lda (p_song),y
   328 806D C9 FE			cmp #$fe
   329 806F B0 2D			bcs nn2
   330 8071 A8				tay
   331 8072 B1 CD			lda (p_trackslbstable),y
   332 8074 9D E0 7C			sta trackn_db,x
   333 8077 B1 CF			lda (p_trackshbstable),y
   334 8079 9D E4 7C		nn1a sta trackn_hb,x
   335 807C A9 00			lda #0
   336 807E 9D E8 7C			sta trackn_idx,x
   337 8081 A9 01			lda #1
   338 8083 9D EC 7C		nn1a2 sta trackn_pause,x
   339 8086 A9 80			lda #$80
   340 8088 9D 14 7D			sta trackn_instrx2,x
   341 808B E8				inx
   342 808C E0 04		xtracks01	cpx #TRACKS
   343 808E D0 D9			bne nn1
   344 8090 A5 D1			lda p_song
   345 8092 18				clc
   346 8093 69 04		xtracks02	adc #TRACKS
   347 8095 85 D1			sta p_song
   348 8097 90 1B			bcc GetTrackLine
   349 8099 E6 D2			inc p_song+1
   350 809B			nn1b
   351 809B 4C B4 80			jmp GetTrackLine
   352 809E			nn2
   353 809E F0 04			beq nn3
   354 80A0			nn2a
   355 80A0 A9 00			lda #0
   356 80A2 F0 DF			beq nn1a2
   357 80A4			nn3
   358 80A4 A0 02			ldy #2
   359 80A6 B1 D1			lda (p_song),y
   360 80A8 AA				tax
   361 80A9 C8				iny
   362 80AA B1 D1			lda (p_song),y
   363 80AC 85 D2			sta p_song+1
   364 80AE 86 D1			stx p_song
   365 80B0 A2 00			ldx #0
   366 80B2 F0 B5			beq nn0
   367 80B4			GetTrackLine
   368 80B4			oo0
   369 80B4			oo0a
   370 					IFT FEAT_CONSTANTSPEED==0
   371 80B4 A9 FF			lda #$ff
   372 = 80B5			v_speed equ *-1
   373 80B6 8D 08 81			sta v_bspeed
   374 					EIF
   375 80B9 A2 FF			ldx #-1
   376 80BB			oo1
   377 80BB E8				inx
   378 80BC DE EC 7C			dec trackn_pause,x
   379 80BF D0 42			bne oo1x
   380 80C1			oo1b
   381 80C1 BD E0 7C			lda trackn_db,x
   382 80C4 85 D3			sta ns
   383 80C6 BD E4 7C			lda trackn_hb,x
   384 80C9 85 D4			sta ns+1
   385 80CB			oo1i
   386 80CB BC E8 7C			ldy trackn_idx,x
   387 80CE FE E8 7C			inc trackn_idx,x
   388 80D1 B1 D3			lda (ns),y
   389 80D3 85 D9			sta reg1
   390 80D5 29 3F			and #$3f
   391 80D7 C9 3D			cmp #61
   392 80D9 F0 0E			beq oo1a
   393 80DB B0 35			bcs oo2
   394 80DD 9D F0 7C			sta trackn_note,x
   395 					IFT FEAT_BASS16
   396 					sta trackn_outnote,x
   397 					EIF
   398 80E0 C8				iny
   399 80E1 B1 D3			lda (ns),y
   400 80E3 4A				lsr @
   401 80E4 29 7E			and #$3f*2
   402 80E6 9D 14 7D			sta trackn_instrx2,x
   403 80E9			oo1a
   404 80E9 A9 01			lda #1
   405 80EB 9D EC 7C			sta trackn_pause,x
   406 80EE BC E8 7C			ldy trackn_idx,x
   407 80F1 FE E8 7C			inc trackn_idx,x
   408 80F4 B1 D3			lda (ns),y
   409 80F6 4A				lsr @
   410 80F7 66 D9			ror reg1
   411 80F9 4A				lsr @
   412 80FA 66 D9			ror reg1
   413 80FC A5 D9			lda reg1
   414 					IFT FEAT_GLOBALVOLUMEFADE
   415 					sec
   416 					sbc #$00
   417 				RMTGLOBALVOLUMEFADE equ *-1
   418 					bcs voig
   419 					lda #0
   420 				voig
   421 					EIF
   422 80FE 29 F0			and #$f0
   423 8100 9D F4 7C			sta trackn_volume,x
   424 8103			oo1x
   425 8103 E0 03		xtracks03sub1	cpx #TRACKS-1
   426 8105 D0 B4			bne oo1
   427 					IFT FEAT_CONSTANTSPEED==0
   428 8107 A9 FF			lda #$ff
   429 = 8108			v_bspeed equ *-1
   430 8109 8D B5 80			sta v_speed
   431 					ELS
   432 					lda #FEAT_CONSTANTSPEED
   433 					EIF
   434 810C 8D 70 7D			sta v_aspeed
   435 810F 4C 57 81			jmp InitOfNewSetInstrumentsOnly
   436 8112			oo2
   437 8112 C9 3F			cmp #63
   438 8114 F0 1B			beq oo63
   439 8116 A5 D9			lda reg1
   440 8118 29 C0			and #$c0
   441 811A F0 09			beq oo62_b
   442 811C 0A				asl @
   443 811D 2A				rol @
   444 811E 2A				rol @
   445 811F 9D EC 7C			sta trackn_pause,x
   446 8122 4C 03 81			jmp oo1x
   447 8125			oo62_b
   448 8125 C8				iny
   449 8126 B1 D3			lda (ns),y
   450 8128 9D EC 7C			sta trackn_pause,x
   451 812B FE E8 7C			inc trackn_idx,x
   452 812E 4C 03 81			jmp oo1x
   453 8131			oo63
   454 8131 A5 D9			lda reg1
   455 					IFT FEAT_CONSTANTSPEED==0
   456 8133 30 0C			bmi oo63_1X
   457 8135 C8				iny
   458 8136 B1 D3			lda (ns),y
   459 8138 8D 08 81			sta v_bspeed
   460 813B FE E8 7C			inc trackn_idx,x
   461 813E 4C CB 80			jmp oo1i
   462 8141			oo63_1X
   463 					EIF
   464 8141 C9 FF			cmp #255
   465 8143 F0 09			beq oo63_11
   466 8145 C8				iny
   467 8146 B1 D3			lda (ns),y
   468 8148 9D E8 7C			sta trackn_idx,x
   469 814B 4C CB 80			jmp oo1i
   470 814E			oo63_11
   471 814E 4C 64 80			jmp GetSongLine
   472 8151 4C F3 81		p2xrmtp3	jmp rmt_p3
   473 8154 CA			p2x0 dex
   474 8155 30 FA			 bmi p2xrmtp3
   475 8157			InitOfNewSetInstrumentsOnly
   476 8157 BC 14 7D		p2x1 ldy trackn_instrx2,x
   477 815A 30 F8			bmi p2x0
   478 					IFT FEAT_SFX
   479 					jsr SetUpInstrumentY2
   480 					jmp p2x0
   481 				rmt_sfx
   482 					sta trackn_note,x
   483 					IFT FEAT_BASS16
   484 					sta trackn_outnote,x
   485 					EIF
   486 					lda #$f0				;* sfx note volume*16
   487 				RMTSFXVOLUME equ *-1		;* label for sfx note volume parameter overwriting
   488 					sta trackn_volume,x
   489 					EIF
   490 815C			SetUpInstrumentY2
   491 815C B1 CB			lda (p_instrstable),y
   492 815E 9D 18 7D			sta trackn_instrdb,x
   493 8161 85 D7			sta nt
   494 8163 C8				iny
   495 8164 B1 CB			lda (p_instrstable),y
   496 8166 9D 1C 7D			sta trackn_instrhb,x
   497 8169 85 D8			sta nt+1
   498 					IFT FEAT_FILTER
   499 816B A9 01			lda #1
   500 816D 9D 60 7D			sta trackn_filter,x
   501 					EIF
   502 					IFT FEAT_TABLEGO
   503 					IFT FEAT_FILTER
   504 8170 A8				tay
   505 					ELS
   506 					ldy #1
   507 					EIF
   508 8171 B1 D7			lda (nt),y
   509 8173 9D 54 7D			sta trackn_tablelop,x
   510 8176 C8				iny
   511 					ELS
   512 					ldy #2
   513 					EIF
   514 8177 B1 D7			lda (nt),y
   515 8179 9D 24 7D			sta trackn_instrlen,x
   516 817C C8				iny
   517 817D B1 D7			lda (nt),y
   518 817F 9D 28 7D			sta trackn_instrlop,x
   519 8182 C8				iny
   520 8183 B1 D7			lda (nt),y
   521 8185 9D 44 7D			sta trackn_tabletypespeed,x
   522 					IFT FEAT_TABLETYPE||FEAT_TABLEMODE
   523 8188 29 3F			and #$3f
   524 					EIF
   525 818A 9D 58 7D			sta trackn_tablespeeda,x
   526 					IFT FEAT_TABLEMODE
   527 					lda (nt),y
   528 					and #$40
   529 					sta trackn_tablemode,x
   530 					EIF
   531 					IFT FEAT_AUDCTLMANUALSET
   532 818D C8				iny
   533 818E B1 D7			lda (nt),y
   534 8190 9D 6C 7D			sta trackn_audctl,x
   535 8193 C8				iny
   536 					ELS
   537 					ldy #6
   538 					EIF
   539 8194 B1 D7			lda (nt),y
   540 8196 9D 30 7D			sta trackn_volumeslidedepth,x
   541 					IFT FEAT_VOLUMEMIN
   542 					iny
   543 					lda (nt),y
   544 					sta trackn_volumemin,x
   545 					IFT FEAT_EFFECTS
   546 					iny
   547 					EIF
   548 					ELS
   549 					IFT FEAT_EFFECTS
   550 8199 A0 08			ldy #8
   551 					EIF
   552 					EIF
   553 					IFT FEAT_EFFECTS
   554 819B B1 D7			lda (nt),y
   555 819D 9D 38 7D			sta trackn_effdelay,x
   556 					IFT FEAT_EFFECTVIBRATO
   557 81A0 C8				iny
   558 81A1 B1 D7			lda (nt),y
   559 81A3 A8				tay
   560 81A4 B9 92 7D			lda vibtabbeg,y
   561 81A7 9D 3C 7D			sta trackn_effvibratoa,x
   562 					EIF
   563 					IFT FEAT_EFFECTFSHIFT
   564 81AA A0 0A			ldy #10
   565 81AC B1 D7			lda (nt),y
   566 81AE 9D 40 7D			sta trackn_effshift,x
   567 					EIF
   568 					EIF
   569 81B1 A9 80			lda #128
   570 81B3 9D 34 7D			sta trackn_volumeslidevalue,x
   571 81B6 9D 14 7D			sta trackn_instrx2,x
   572 81B9 0A				asl @
   573 81BA 9D 2C 7D			sta trackn_instrreachend,x
   574 81BD 9D FC 7C			sta trackn_shiftfrq,x
   575 81C0 A8				tay
   576 81C1 B1 D7			lda (nt),y
   577 81C3 9D 50 7D			sta trackn_tableend,x
   578 81C6 69 00			adc #0
   579 81C8 9D 20 7D			sta trackn_instridx,x
   580 81CB A9 0C			lda #INSTRPAR
   581 81CD 9D 4C 7D			sta trackn_tablea,x
   582 81D0 A8				tay
   583 81D1 B1 D7			lda (nt),y
   584 81D3 9D 48 7D			sta trackn_tablenote,x
   585 81D6			xata_rtshere
   586 					IFT FEAT_SFX
   587 					rts
   588 					ELS
   589 81D6 4C 54 81			jmp p2x0
   590 					EIF
   591 81D9			rmt_play
   592 81D9			rmt_p0
   593 81D9 20 29 84			jsr SetPokey
   594 81DC			rmt_p1
   595 					IFT FEAT_INSTRSPEED==0||FEAT_INSTRSPEED>1
   596 					dec v_ainstrspeed
   597 					bne rmt_p3
   598 					EIF
   599 					IFT FEAT_INSTRSPEED==0
   600 					lda #$ff
   601 				v_instrspeed	equ *-1
   602 					sta v_ainstrspeed
   603 					ELI FEAT_INSTRSPEED>1
   604 					lda #FEAT_INSTRSPEED
   605 					sta v_ainstrspeed
   606 					EIF
   607 81DC			rmt_p2
   608 81DC CE 70 7D			dec v_aspeed
   609 81DF D0 12			bne rmt_p3
   610 81E1 EE E5 81			inc v_abeat
   611 81E4 A9 FF			lda #$ff
   612 = 81E5			v_abeat equ *-1
   613 81E6 C9 FF			cmp #$ff
   614 = 81E7			v_maxtracklen equ *-1
   615 81E8 F0 03			beq p2o3
   616 81EA 4C B4 80			jmp GetTrackLine
   617 81ED			p2o3
   618 81ED 4C 64 80			jmp GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   619 81F0 4C CA 83		go_ppnext	jmp ppnext
   620 81F3			rmt_p3
   621 81F3 A9 7E			lda #>frqtab
   622 81F5 85 D6			sta nr+1
   623 81F7 A2 03		xtracks05sub1	ldx #TRACKS-1
   624 81F9			pp1
   625 81F9 BD 1C 7D			lda trackn_instrhb,x
   626 81FC F0 F2			beq go_ppnext
   627 81FE 85 D4			sta ns+1
   628 8200 BD 18 7D			lda trackn_instrdb,x
   629 8203 85 D3			sta ns
   630 8205 BC 20 7D			ldy trackn_instridx,x
   631 8208 B1 D3			lda (ns),y
   632 820A 85 D9			sta reg1
   633 820C C8				iny
   634 820D B1 D3			lda (ns),y
   635 820F 85 DA			sta reg2
   636 8211 C8				iny
   637 8212 B1 D3			lda (ns),y
   638 8214 85 DB			sta reg3
   639 8216 C8				iny
   640 8217 98				tya
   641 8218 DD 24 7D			cmp trackn_instrlen,x
   642 821B 90 0A			bcc pp2
   643 821D F0 08			beq pp2
   644 821F A9 80			lda #$80
   645 8221 9D 2C 7D			sta trackn_instrreachend,x
   646 8224			pp1b
   647 8224 BD 28 7D			lda trackn_instrlop,x
   648 8227 9D 20 7D		pp2	sta trackn_instridx,x
   649 822A A5 D9			lda reg1
   650 					IFT TRACKS>4
   651 					cpx #4
   652 					bcc pp2s
   653 					lsr @
   654 					lsr @
   655 					lsr @
   656 					lsr @
   657 				pp2s
   658 					EIF
   659 822C 29 0F			and #$0f
   660 822E 1D F4 7C			ora trackn_volume,x
   661 8231 A8				tay
   662 8232 B9 00 7F			lda volumetab,y
   663 8235 85 DC			sta tmp
   664 8237 A5 DA			lda reg2
   665 8239 29 0E			and #$0e
   666 823B A8				tay
   667 823C B9 82 7D			lda tabbeganddistor,y
   668 823F 85 D5			sta nr
   669 8241 A5 DC			lda tmp
   670 8243 19 83 7D			ora tabbeganddistor+1,y
   671 8246 9D 68 7D			sta trackn_audc,x
   672 8249			InstrumentsEffects
   673 					IFT FEAT_EFFECTS
   674 8249 BD 38 7D			lda trackn_effdelay,x
   675 824C F0 21			beq ei2
   676 824E C9 01			cmp #1
   677 8250 D0 1A			bne ei1
   678 8252 BD FC 7C			lda trackn_shiftfrq,x
   679 					IFT FEAT_EFFECTFSHIFT
   680 8255 18				clc
   681 8256 7D 40 7D			adc trackn_effshift,x
   682 					EIF
   683 					IFT FEAT_EFFECTVIBRATO
   684 8259 18				clc
   685 825A BC 3C 7D			ldy trackn_effvibratoa,x
   686 825D 79 96 7D			adc vib0,y
   687 					EIF
   688 8260 9D FC 7C			sta trackn_shiftfrq,x
   689 					IFT FEAT_EFFECTVIBRATO
   690 8263 B9 AB 7D			lda vibtabnext,y
   691 8266 9D 3C 7D			sta trackn_effvibratoa,x
   692 					EIF
   693 8269 4C 6F 82			jmp ei2
   694 826C			ei1
   695 826C DE 38 7D			dec trackn_effdelay,x
   696 826F			ei2
   697 					EIF
   698 826F BC 50 7D			ldy trackn_tableend,x
   699 8272 C0 0D			cpy #INSTRPAR+1
   700 8274 90 33			bcc ei3
   701 8276 BD 58 7D			lda trackn_tablespeeda,x
   702 8279 10 28			bpl ei2f
   703 827B			ei2c
   704 827B 98				tya
   705 827C DD 4C 7D			cmp trackn_tablea,x
   706 827F D0 08			bne ei2c2
   707 					IFT FEAT_TABLEGO
   708 8281 BD 54 7D			lda trackn_tablelop,x
   709 					ELS
   710 					lda #INSTRPAR
   711 					EIF
   712 8284 9D 4C 7D			sta trackn_tablea,x
   713 8287 D0 03			bne ei2a
   714 8289			ei2c2
   715 8289 FE 4C 7D			inc trackn_tablea,x
   716 828C			ei2a
   717 828C BD 18 7D			lda trackn_instrdb,x
   718 828F 85 D7			sta nt
   719 8291 BD 1C 7D			lda trackn_instrhb,x
   720 8294 85 D8			sta nt+1
   721 8296 BC 4C 7D			ldy trackn_tablea,x
   722 8299 B1 D7			lda (nt),y
   723 					IFT FEAT_TABLEMODE
   724 					ldy trackn_tablemode,x
   725 					beq ei2e
   726 					clc
   727 					adc trackn_tablenote,x
   728 				ei2e
   729 					EIF
   730 829B 9D 48 7D			sta trackn_tablenote,x
   731 829E BD 44 7D			lda trackn_tabletypespeed,x
   732 					IFT FEAT_TABLETYPE||FEAT_TABLEMODE
   733 82A1 29 3F			and #$3f
   734 					EIF
   735 82A3			ei2f
   736 82A3 38				sec
   737 82A4 E9 01			sbc #1
   738 82A6 9D 58 7D			sta trackn_tablespeeda,x
   739 82A9			ei3
   740 82A9 BD 2C 7D			lda trackn_instrreachend,x
   741 82AC 10 18			bpl ei4
   742 82AE BD F4 7C			lda trackn_volume,x
   743 82B1 F0 13			beq ei4
   744 					IFT FEAT_VOLUMEMIN
   745 					cmp trackn_volumemin,x
   746 					beq ei4
   747 					bcc ei4
   748 					EIF
   749 82B3 A8				tay
   750 82B4 BD 34 7D			lda trackn_volumeslidevalue,x
   751 82B7 18				clc
   752 82B8 7D 30 7D			adc trackn_volumeslidedepth,x
   753 82BB 9D 34 7D			sta trackn_volumeslidevalue,x
   754 82BE 90 06			bcc ei4
   755 82C0 98				tya
   756 82C1 E9 10			sbc #16
   757 82C3 9D F4 7C			sta trackn_volume,x
   758 82C6			ei4
   759 					IFT FEAT_COMMAND2
   760 					lda #0
   761 					sta frqaddcmd2
   762 					EIF
   763 					IFT FEAT_COMMAND1||FEAT_COMMAND2||FEAT_COMMAND3||FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   764 82C6 A5 DA			lda reg2
   765 					IFT FEAT_FILTER||FEAT_BASS16
   766 82C8 9D 5C 7D			sta trackn_command,x
   767 					EIF
   768 82CB 29 70			and #$70
   769 					IFT 1==[FEAT_COMMAND1+FEAT_COMMAND2+FEAT_COMMAND3+FEAT_COMMAND4+FEAT_COMMAND5+FEAT_COMMAND6+[FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY]]
   770 					beq cmd0
   771 					ELS
   772 82CD 4A				lsr @
   773 82CE 4A				lsr @
   774 82CF 8D D3 82			sta jmx+1
   775 82D2 90 FE		jmx	bcc *
   776 82D4 4C 46 83			jmp cmd0
   777 82D7 EA				nop
   778 82D8 4C EF 82			jmp cmd1
   779 					IFT FEAT_COMMAND2||FEAT_COMMAND3||FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   780 82DB EA				nop
   781 82DC 4C F4 82			jmp cmd2
   782 					EIF
   783 					IFT FEAT_COMMAND3||FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   784 82DF EA				nop
   785 82E0 4C F4 82			jmp cmd3
   786 					EIF
   787 					IFT FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   788 82E3 EA				nop
   789 82E4 4C F4 82			jmp cmd4
   790 					EIF
   791 					IFT FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   792 82E7 EA				nop
   793 82E8 4C F4 82			jmp cmd5
   794 					EIF
   795 					IFT FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   796 82EB EA				nop
   797 82EC 4C 37 83			jmp cmd6
   798 					EIF
   799 					IFT FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   800 					nop
   801 					jmp cmd7
   802 					EIF
   803 					EIF
   804 					ELS
   805 					IFT FEAT_FILTER||FEAT_BASS16
   806 					lda reg2
   807 					sta trackn_command,x
   808 					EIF
   809 					EIF
   810 82EF			cmd1
   811 					IFT FEAT_COMMAND1
   812 82EF A5 DB			lda reg3
   813 82F1 4C 80 83			jmp cmd0c
   814 					EIF
   815 82F4			cmd2
   816 					IFT FEAT_COMMAND2
   817 					lda reg3
   818 					sta frqaddcmd2
   819 					lda trackn_note,x
   820 					jmp cmd0a
   821 					EIF
   822 82F4			cmd3
   823 					IFT FEAT_COMMAND3
   824 					lda trackn_note,x
   825 					clc
   826 					adc reg3
   827 					sta trackn_note,x
   828 					jmp cmd0a
   829 					EIF
   830 82F4			cmd4
   831 					IFT FEAT_COMMAND4
   832 					lda trackn_shiftfrq,x
   833 					clc
   834 					adc reg3
   835 					sta trackn_shiftfrq,x
   836 					lda trackn_note,x
   837 					jmp cmd0a
   838 					EIF
   839 82F4			cmd5
   840 					IFT FEAT_COMMAND5&&FEAT_PORTAMENTO
   841 					IFT FEAT_TABLETYPE
   842 82F4 BD 44 7D			lda trackn_tabletypespeed,x
   843 82F7 10 0C			bpl cmd5a1
   844 82F9 BC F0 7C			ldy trackn_note,x
   845 82FC B1 D5			lda (nr),y
   846 82FE 18				clc
   847 82FF 7D 48 7D			adc trackn_tablenote,x
   848 8302 4C 15 83			jmp cmd5ax
   849 					EIF
   850 8305			cmd5a1
   851 8305 BD F0 7C			lda trackn_note,x
   852 8308 18				clc
   853 8309 7D 48 7D			adc trackn_tablenote,x
   854 830C C9 3D			cmp #61
   855 830E 90 02			bcc cmd5a2
   856 8310 A9 3F			lda #63
   857 8312			cmd5a2
   858 8312 A8				tay
   859 8313 B1 D5			lda (nr),y
   860 8315			cmd5ax
   861 8315 9D 00 7D			sta trackn_portafrqc,x
   862 8318 A4 DB			ldy reg3
   863 831A D0 03			bne cmd5a
   864 831C 9D 04 7D			sta trackn_portafrqa,x
   865 831F			cmd5a
   866 831F 98				tya
   867 8320 4A				lsr @
   868 8321 4A				lsr @
   869 8322 4A				lsr @
   870 8323 4A				lsr @
   871 8324 9D 08 7D			sta trackn_portaspeed,x
   872 8327 9D 0C 7D			sta trackn_portaspeeda,x
   873 832A A5 DB			lda reg3
   874 832C 29 0F			and #$0f
   875 832E 9D 10 7D			sta trackn_portadepth,x
   876 8331 BD F0 7C			lda trackn_note,x
   877 8334 4C 4C 83			jmp cmd0a
   878 					ELI FEAT_COMMAND5
   879 					lda trackn_note,x
   880 					jmp cmd0a
   881 					EIF
   882 8337			cmd6
   883 					IFT FEAT_COMMAND6&&FEAT_FILTER
   884 8337 A5 DB			lda reg3
   885 8339 18				clc
   886 833A 7D 60 7D			adc trackn_filter,x
   887 833D 9D 60 7D			sta trackn_filter,x
   888 8340 BD F0 7C			lda trackn_note,x
   889 8343 4C 4C 83			jmp cmd0a
   890 					ELI FEAT_COMMAND6
   891 					lda trackn_note,x
   892 					jmp cmd0a
   893 					EIF
   894 8346			cmd7
   895 					IFT FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   896 					IFT FEAT_COMMAND7SETNOTE
   897 					lda reg3
   898 					IFT FEAT_COMMAND7VOLUMEONLY
   899 					cmp #$80
   900 					beq cmd7a
   901 					EIF
   902 					sta trackn_note,x
   903 					jmp cmd0a
   904 					EIF
   905 					IFT FEAT_COMMAND7VOLUMEONLY
   906 				cmd7a
   907 					lda trackn_audc,x
   908 					ora #$f0
   909 					sta trackn_audc,x
   910 					lda trackn_note,x
   911 					jmp cmd0a
   912 					EIF
   913 					EIF
   914 8346			cmd0
   915 8346 BD F0 7C			lda trackn_note,x
   916 8349 18				clc
   917 834A 65 DB			adc reg3
   918 834C			cmd0a
   919 					IFT FEAT_TABLETYPE
   920 834C BC 44 7D			ldy trackn_tabletypespeed,x
   921 834F 30 19			bmi cmd0b
   922 					EIF
   923 8351 18				clc
   924 8352 7D 48 7D			adc trackn_tablenote,x
   925 8355 C9 3D			cmp #61
   926 8357 90 07			bcc cmd0a1
   927 8359 A9 00			lda #0
   928 835B 9D 68 7D			sta trackn_audc,x
   929 835E A9 3F			lda #63
   930 8360			cmd0a1
   931 					IFT FEAT_BASS16
   932 					sta trackn_outnote,x
   933 					EIF
   934 8360 A8				tay
   935 8361 B1 D5			lda (nr),y
   936 8363 18				clc
   937 8364 7D FC 7C			adc trackn_shiftfrq,x
   938 					IFT FEAT_COMMAND2
   939 					clc
   940 					adc frqaddcmd2
   941 					EIF
   942 					IFT FEAT_TABLETYPE
   943 8367 4C 80 83			jmp cmd0c
   944 836A			cmd0b
   945 836A C9 3D			cmp #61
   946 836C 90 07			bcc cmd0b1
   947 836E A9 00			lda #0
   948 8370 9D 68 7D			sta trackn_audc,x
   949 8373 A9 3F			lda #63
   950 8375			cmd0b1
   951 8375 A8				tay
   952 8376 BD FC 7C			lda trackn_shiftfrq,x
   953 8379 18				clc
   954 837A 7D 48 7D			adc trackn_tablenote,x
   955 837D 18				clc
   956 837E 71 D5			adc (nr),y
   957 					IFT FEAT_COMMAND2
   958 					clc
   959 					adc frqaddcmd2
   960 					EIF
   961 					EIF
   962 8380			cmd0c
   963 8380 9D 64 7D			sta trackn_audf,x
   964 8383			pp9
   965 					IFT FEAT_PORTAMENTO
   966 8383 BD 0C 7D			lda trackn_portaspeeda,x
   967 8386 F0 32			beq pp10
   968 8388 DE 0C 7D			dec trackn_portaspeeda,x
   969 838B D0 2D			bne pp10
   970 838D BD 08 7D			lda trackn_portaspeed,x
   971 8390 9D 0C 7D			sta trackn_portaspeeda,x
   972 8393 BD 04 7D			lda trackn_portafrqa,x
   973 8396 DD 00 7D			cmp trackn_portafrqc,x
   974 8399 F0 1F			beq pp10
   975 839B B0 0D			bcs pps1
   976 839D 7D 10 7D			adc trackn_portadepth,x
   977 83A0 B0 12			bcs pps8
   978 83A2 DD 00 7D			cmp trackn_portafrqc,x
   979 83A5 B0 0D			bcs pps8
   980 83A7 4C B7 83			jmp pps9
   981 83AA			pps1
   982 83AA FD 10 7D			sbc trackn_portadepth,x
   983 83AD 90 05			bcc pps8
   984 83AF DD 00 7D			cmp trackn_portafrqc,x
   985 83B2 B0 03			bcs pps9
   986 83B4			pps8
   987 83B4 BD 00 7D			lda trackn_portafrqc,x
   988 83B7			pps9
   989 83B7 9D 04 7D			sta trackn_portafrqa,x
   990 83BA			pp10
   991 83BA A5 DA			lda reg2
   992 83BC 29 01			and #$01
   993 83BE F0 0A			beq pp11
   994 83C0 BD 04 7D			lda trackn_portafrqa,x
   995 83C3 18				clc
   996 83C4 7D FC 7C			adc trackn_shiftfrq,x
   997 83C7 9D 64 7D			sta trackn_audf,x
   998 83CA			pp11
   999 					EIF
  1000 83CA			ppnext
  1001 83CA CA				dex
  1002 83CB 30 03			bmi rmt_p4
  1003 83CD 4C F9 81			jmp pp1
  1004 83D0			rmt_p4
  1005 					IFT FEAT_AUDCTLMANUALSET
  1006 83D0 AD 6C 7D			lda trackn_audctl+0
  1007 83D3 0D 6D 7D			ora trackn_audctl+1
  1008 83D6 0D 6E 7D			ora trackn_audctl+2
  1009 83D9 0D 6F 7D			ora trackn_audctl+3
  1010 83DC AA				tax
  1011 					ELS
  1012 					ldx #0
  1013 					EIF
  1014 83DD			qq1
  1015 83DD 8E 2A 84			stx v_audctl
  1016 					IFT FEAT_FILTER
  1017 					IFT FEAT_FILTERG0L
  1018 83E0 AD 5C 7D			lda trackn_command+0
  1019 83E3 10 1A			bpl qq2
  1020 83E5 AD 68 7D			lda trackn_audc+0
  1021 83E8 29 0F			and #$0f
  1022 83EA F0 13			beq qq2
  1023 83EC AD 64 7D			lda trackn_audf+0
  1024 83EF 18				clc
  1025 83F0 6D 60 7D			adc trackn_filter+0
  1026 83F3 8D 66 7D			sta trackn_audf+2
  1027 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2L
  1028 					lda trackn_audc+2
  1029 					and #$10
  1030 					bne qq1a
  1031 					EIF
  1032 83F6 A9 00			lda #0
  1033 83F8 8D 6A 7D			sta trackn_audc+2
  1034 83FB			qq1a
  1035 83FB 8A				txa
  1036 83FC 09 04			ora #4
  1037 83FE AA				tax
  1038 					EIF
  1039 83FF			qq2
  1040 					IFT FEAT_FILTERG1L
  1041 83FF AD 5D 7D			lda trackn_command+1
  1042 8402 10 1A			bpl qq3
  1043 8404 AD 69 7D			lda trackn_audc+1
  1044 8407 29 0F			and #$0f
  1045 8409 F0 13			beq qq3
  1046 840B AD 65 7D			lda trackn_audf+1
  1047 840E 18				clc
  1048 840F 6D 61 7D			adc trackn_filter+1
  1049 8412 8D 67 7D			sta trackn_audf+3
  1050 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG3L
  1051 					lda trackn_audc+3
  1052 					and #$10
  1053 					bne qq2a
  1054 					EIF
  1055 8415 A9 00			lda #0
  1056 8417 8D 6B 7D			sta trackn_audc+3
  1057 841A			qq2a
  1058 841A 8A				txa
  1059 841B 09 02			ora #2
  1060 841D AA				tax
  1061 					EIF
  1062 841E			qq3
  1063 					IFT FEAT_FILTERG0L||FEAT_FILTERG1L
  1064 841E EC 2A 84			cpx v_audctl
  1065 8421 D0 00			bne qq5
  1066 					EIF
  1067 					EIF
  1068 					IFT FEAT_BASS16
  1069 					IFT FEAT_BASS16G1L
  1070 					lda trackn_command+1
  1071 					and #$0e
  1072 					cmp #6
  1073 					bne qq4
  1074 					lda trackn_audc+1
  1075 					and #$0f
  1076 					beq qq4
  1077 					ldy trackn_outnote+1
  1078 					lda frqtabbasslo,y
  1079 					sta trackn_audf+0
  1080 					lda frqtabbasshi,y
  1081 					sta trackn_audf+1
  1082 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG0L
  1083 					lda trackn_audc+0
  1084 					and #$10
  1085 					bne qq3a
  1086 					EIF
  1087 					lda #0
  1088 					sta trackn_audc+0
  1089 				qq3a
  1090 					txa
  1091 					ora #$50
  1092 					tax
  1093 					EIF
  1094 				qq4
  1095 					IFT FEAT_BASS16G3L
  1096 					lda trackn_command+3
  1097 					and #$0e
  1098 					cmp #6
  1099 					bne qq5
  1100 					lda trackn_audc+3
  1101 					and #$0f
  1102 					beq qq5
  1103 					ldy trackn_outnote+3
  1104 					lda frqtabbasslo,y
  1105 					sta trackn_audf+2
  1106 					lda frqtabbasshi,y
  1107 					sta trackn_audf+3
  1108 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2L
  1109 					lda trackn_audc+2
  1110 					and #$10
  1111 					bne qq4a
  1112 					EIF
  1113 					lda #0
  1114 					sta trackn_audc+2
  1115 				qq4a
  1116 					txa
  1117 					ora #$28
  1118 					tax
  1119 					EIF
  1120 					EIF
  1121 8423			qq5
  1122 8423 8E 2A 84			stx v_audctl
  1123 					IFT TRACKS>4
  1124 					IFT FEAT_AUDCTLMANUALSET
  1125 					lda trackn_audctl+4
  1126 					ora trackn_audctl+5
  1127 					ora trackn_audctl+6
  1128 					ora trackn_audctl+7
  1129 					tax
  1130 					ELS
  1131 					ldx #0
  1132 					EIF
  1133 					stx v_audctl2
  1134 					IFT FEAT_FILTER
  1135 					IFT FEAT_FILTERG0R
  1136 					lda trackn_command+0+4
  1137 					bpl qs2
  1138 					lda trackn_audc+0+4
  1139 					and #$0f
  1140 					beq qs2
  1141 					lda trackn_audf+0+4
  1142 					clc
  1143 					adc trackn_filter+0+4
  1144 					sta trackn_audf+2+4
  1145 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2R
  1146 					lda trackn_audc+2+4
  1147 					and #$10
  1148 					bne qs1a
  1149 					EIF
  1150 					lda #0
  1151 					sta trackn_audc+2+4
  1152 				qs1a
  1153 					txa
  1154 					ora #4
  1155 					tax
  1156 					EIF
  1157 				qs2
  1158 					IFT FEAT_FILTERG1R
  1159 					lda trackn_command+1+4
  1160 					bpl qs3
  1161 					lda trackn_audc+1+4
  1162 					and #$0f
  1163 					beq qs3
  1164 					lda trackn_audf+1+4
  1165 					clc
  1166 					adc trackn_filter+1+4
  1167 					sta trackn_audf+3+4
  1168 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG3R
  1169 					lda trackn_audc+3+4
  1170 					and #$10
  1171 					bne qs2a
  1172 					EIF
  1173 					lda #0
  1174 					sta trackn_audc+3+4
  1175 				qs2a
  1176 					txa
  1177 					ora #2
  1178 					tax
  1179 					EIF
  1180 				qs3
  1181 					IFT FEAT_FILTERG0R||FEAT_FILTERG1R
  1182 					cpx v_audctl2
  1183 					bne qs5
  1184 					EIF
  1185 					EIF
  1186 					IFT FEAT_BASS16
  1187 					IFT FEAT_BASS16G1R
  1188 					lda trackn_command+1+4
  1189 					and #$0e
  1190 					cmp #6
  1191 					bne qs4
  1192 					lda trackn_audc+1+4
  1193 					and #$0f
  1194 					beq qs4
  1195 					ldy trackn_outnote+1+4
  1196 					lda frqtabbasslo,y
  1197 					sta trackn_audf+0+4
  1198 					lda frqtabbasshi,y
  1199 					sta trackn_audf+1+4
  1200 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG0R
  1201 					lda trackn_audc+0+4
  1202 					and #$10
  1203 					bne qs3a
  1204 					EIF
  1205 					lda #0
  1206 					sta trackn_audc+0+4
  1207 				qs3a
  1208 					txa
  1209 					ora #$50
  1210 					tax
  1211 					EIF
  1212 				qs4
  1213 					IFT FEAT_BASS16G3R
  1214 					lda trackn_command+3+4
  1215 					and #$0e
  1216 					cmp #6
  1217 					bne qs5
  1218 					lda trackn_audc+3+4
  1219 					and #$0f
  1220 					beq qs5
  1221 					ldy trackn_outnote+3+4
  1222 					lda frqtabbasslo,y
  1223 					sta trackn_audf+2+4
  1224 					lda frqtabbasshi,y
  1225 					sta trackn_audf+3+4
  1226 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2R
  1227 					lda trackn_audc+2+4
  1228 					and #$10
  1229 					bne qs4a
  1230 					EIF
  1231 					lda #0
  1232 					sta trackn_audc+2+4
  1233 				qs4a
  1234 					txa
  1235 					ora #$28
  1236 					tax
  1237 					EIF
  1238 					EIF
  1239 				qs5
  1240 					stx v_audctl2
  1241 					EIF
  1242 8426			rmt_p5
  1243 					IFT FEAT_INSTRSPEED==0||FEAT_INSTRSPEED>1
  1244 					lda #$ff
  1245 				v_ainstrspeed equ *-1
  1246 					ELS
  1247 8426 A9 01			lda #1
  1248 					EIF
  1249 8428 60				rts
  1250 8429			SetPokey
  1251 					IFT STEREOMODE==1		;* L1 L2 L3 L4 R1 R2 R3 R4
  1252 					ldy #$ff
  1253 				v_audctl2 equ *-1
  1254 					lda trackn_audf+0+4
  1255 					ldx trackn_audf+0
  1256 				xstastx01	sta $d210
  1257 					stx $d200
  1258 					lda trackn_audc+0+4
  1259 					ldx trackn_audc+0
  1260 				xstastx02	sta $d211
  1261 					stx $d201
  1262 					lda trackn_audf+1+4
  1263 					ldx trackn_audf+1
  1264 				xstastx03	sta $d212
  1265 					stx $d202
  1266 					lda trackn_audc+1+4
  1267 					ldx trackn_audc+1
  1268 				xstastx04	sta $d213
  1269 					stx $d203
  1270 					lda trackn_audf+2+4
  1271 					ldx trackn_audf+2
  1272 				xstastx05	sta $d214
  1273 					stx $d204
  1274 					lda trackn_audc+2+4
  1275 					ldx trackn_audc+2
  1276 				xstastx06	sta $d215
  1277 					stx $d205
  1278 					lda trackn_audf+3+4
  1279 					ldx trackn_audf+3
  1280 				xstastx07	sta $d216
  1281 					stx $d206
  1282 					lda trackn_audc+3+4
  1283 					ldx trackn_audc+3
  1284 				xstastx08	sta $d217
  1285 					stx $d207
  1286 					lda #$ff
  1287 				v_audctl equ *-1
  1288 				xstysta01	sty $d218
  1289 					sta $d208
  1290 					ELI STEREOMODE==0		;* L1 L2 L3 L4
  1291 8429 A0 FF			ldy #$ff
  1292 = 842A			v_audctl equ *-1
  1293 842B AD 64 7D			lda trackn_audf+0
  1294 842E AE 68 7D			ldx trackn_audc+0
  1295 8431 8D 00 D2			sta $d200
  1296 8434 8E 01 D2			stx $d201
  1297 8437 AD 65 7D			lda trackn_audf+1
  1298 843A AE 69 7D			ldx trackn_audc+1
  1299 843D 8D 02 D2			sta $d200+2
  1300 8440 8E 03 D2			stx $d201+2
  1301 8443 AD 66 7D			lda trackn_audf+2
  1302 8446 AE 6A 7D			ldx trackn_audc+2
  1303 8449 8D 04 D2			sta $d200+4
  1304 844C 8E 05 D2			stx $d201+4
  1305 844F AD 67 7D			lda trackn_audf+3
  1306 8452 AE 6B 7D			ldx trackn_audc+3
  1307 8455 8D 06 D2			sta $d200+6
  1308 8458 8E 07 D2			stx $d201+6
  1309 845B 8C 08 D2			sty $d208
  1310 					ELI STEREOMODE==2		;* L1 R2 R3 L4
  1311 					ldy #$ff
  1312 				v_audctl equ *-1
  1313 					lda trackn_audf+0
  1314 					ldx trackn_audc+0
  1315 					sta $d200
  1316 					stx $d201
  1317 					sta $d210
  1318 					lda trackn_audf+1
  1319 					ldx trackn_audc+1
  1320 					sta $d210+2
  1321 					stx $d211+2
  1322 					lda trackn_audf+2
  1323 					ldx trackn_audc+2
  1324 					sta $d210+4
  1325 					stx $d211+4
  1326 					sta $d200+4
  1327 					lda trackn_audf+3
  1328 					ldx trackn_audc+3
  1329 					sta $d200+6
  1330 					stx $d201+6
  1331 					sta $d210+6
  1332 					sty $d218
  1333 					sty $d208
  1334 					ELI STEREOMODE==3		;* L1 L2 R3 R4
  1335 					ldy #$ff
  1336 				v_audctl equ *-1
  1337 					lda trackn_audf+0
  1338 					ldx trackn_audc+0
  1339 					sta $d200
  1340 					stx $d201
  1341 					lda trackn_audf+1
  1342 					ldx trackn_audc+1
  1343 					sta $d200+2
  1344 					stx $d201+2
  1345 					lda trackn_audf+2
  1346 					ldx trackn_audc+2
  1347 					sta $d210+4
  1348 					stx $d211+4
  1349 					sta $d200+4
  1350 					lda trackn_audf+3
  1351 					ldx trackn_audc+3
  1352 					sta $d210+6
  1353 					stx $d211+6
  1354 					sta $d200+6
  1355 					sty $d218
  1356 					sty $d208
  1357 					EIF
  1358 845E 60				rts
  1359 845F			RMTPLAYEREND
    13
    14 845F					icl "title_1.h"
Source: title_1.h
     1
     2 845F			.enum	@dmactl
     3 = 0000				blank	= %00
     4 = 0001				narrow	= %01
     5 = 0002				standard= %10
     6 = 0003				wide	= %11
     7 = 0004				missiles= %100
     8 = 0008				players	= %1000
     9 = 0010				lineX1	= %10000
    10 = 0000				lineX2	= %00000
    11 = 0020				dma	= %100000
    12 				.ende
    13
    14 = 003F			scr48	= @dmactl(wide|dma|players|missiles|lineX1)		;screen 48b
    15 = 003E			scr40	= @dmactl(standard|dma|players|missiles|lineX1)		;screen 40b
    16 = 003D			scr32	= @dmactl(narrow|dma|players|missiles|lineX1)		;screen 32b
    17
    18 845F			.enum	@pmcntl
    19 = 0001				missiles= %1
    20 = 0002				players	= %10
    21 = 0004				trigs	= %100
    22 				.ende
    23
    24 845F			.enum	@gtictl
    25 = 0000				prior0	= %0
    26 = 0001				prior1	= %1
    27 = 0002				prior2	= %10
    28 = 0004				prior4	= %100
    29 = 0008				prior8	= %1000
    30 = 0010				ply5	= %10000	; Fifth Player Enable
    31 = 0020				mlc	= %100000	; Multiple Color Player Enable
    32 = 0040				mode9	= %01000000
    33 = 0080				mode10	= %10000000
    34 = 00C0				mode11	= %11000000
    35 				.ende
    36
    37
    38 				* ---------------------------------------------------------------------------------------------
    39 				* ---	OS
    40 				* ---------------------------------------------------------------------------------------------
    41
    42 = 0052			lmargin	= $52
    43 = 0053			rmargin	= $53
    44 = 0054			rowcrs	= $54
    45 = 0055			colcrs	= $55
    46
    47 				* ---------------------------------------------------------------------------------------------
    48 				* ---	KEY ($d209)
    49 				* ---------------------------------------------------------------------------------------------
    50 = 001C			key_esc		= 28
    51 = 0021			key_space	= 33
    52 = 0010			key_v		= 16
    53 = 0015			key_b		= 21
    54 = 0023			key_n		= 35
    55 = 0025			key_m		= 37
    56
    57 				* ---------------------------------------------------------------------------------------------
    58 				* ---	GTIA
    59 				* ---------------------------------------------------------------------------------------------
    60 = D000			hposp0	=	$D000		; pozioma pozycja gracza 0 (Z)
    61 = D001			hposp1	=	$D001		; pozioma pozycja gracza 1 (Z)
    62 = D002			hposp2	=	$D002		; pozioma pozycja gracza 2 (Z)
    63 = D003			hposp3	=	$D003		; pozioma pozycja gracza 3 (Z)
    64 = D004			hposm0	=	$D004		; pozioma pozycja pocisku 0 (Z)
    65 = D005			hposm1	=	$D005		; pozioma pozycja pocisku 1 (Z)
    66 = D006			hposm2	=	$D006		; pozioma pozycja pocisku 2 (Z)
    67 = D007			hposm3	=	$D007		; pozioma pozycja pocisku 3 (Z)
    68 = D008			sizep0	=	$D008		; poziomy rozmiar gracza 0 (Z)
    69 = D009			sizep1	=	$D009		; poziomy rozmiar gracza 1 (Z)
    70 = D00A			sizep2	=	$D00A		; poziomy rozmiar gracza 2 (Z)
    71 = D00B			sizep3	=	$D00B		; poziomy rozmiar gracza 3 (Z)
    72 = D00C			sizem	=	$D00C		; poziomy rozmiar pocisków (Z)
    73 = D00D			grafp0	=	$D00D		; rejestr grafiki gracza 0 (Z)
    74 = D00E			grafp1	=	$D00E		; rejestr grafiki gracza 1 (Z)
    75 = D00F			grafp2	=	$D00F		; rejestr grafiki gracza 2 (Z)
    76 = D010			grafp3	=	$D010		; rejestr grafiki gracza 3 (Z)
    77 = D011			grafm	=	$D011		; rejestr grafiki pocisków (Z)
    78 = D012			colpm0	=	$D012		; rejestr koloru gracza i pocisku 0 (Z)
    79 = D013			colpm1	=	$D013		; rejestr koloru gracza i pocisku 1 (Z)
    80 = D014			colpm2	=	$D014		; rejestr koloru gracza i pocisku 2 (Z)
    81 = D015			colpm3	=	$D015		; rejestr koloru gracza i pocisku 3 (Z)
    82 = D016			colpf0	=	$D016		; rejestr koloru pola gry 0 (Z)
    83 = D017			colpf1	=	$D017		; rejestr koloru pola gry 1 (Z)
    84 = D018			colpf2	=	$D018		; rejestr koloru pola gry 2 (Z)
    85 = D019			colpf3	=	$D019		; rejestr koloru pola gry 3 (Z)
    86 = D01A			colbak	=	$D01A		; rejestr koloru t³a (Z)
    87
    88 = D016			color0	=	colpf0
    89 = D017			color1	=	colpf1
    90 = D018			color2	=	colpf2
    91 = D019			color3	=	colpf3
    92
    93 = D000			kolm0pf	=	$D000		; kolizja pocisku 0 z polem gry (O)
    94 = D001			kolm1pf	=	$D001		; kolizja pocisku 1 z polem gry (O)
    95 = D002			kolm2pf	=	$D002		; kolizja pocisku 2 z polem gry (O)
    96 = D003			kolm3pf	=	$D003		; kolizja pocisku 3 z polem gry (O)
    97 = D004			kolp0pf	=	$D004		; kolizja gracza 0 z polem gry (O)
    98 = D005			kolp1pf	=	$D005		; kolizja gracza 1 z polem gry (O)
    99 = D006			kolp2pf	=	$D006		; kolizja gracza 2 z polem gry (O)
   100 = D007			kolp3pf	=	$D007		; kolizja gracza 3 z polem gry (O)
   101 = D008			kolm0p	=	$D008		; kolizja pocisku 0 z graczem (O)
   102 = D009			kolm1p	=	$D009		; kolizja pocisku 1 z graczem (O)
   103 = D00A			kolm2p	=	$D00A		; kolizja pocisku 2 z graczem (O)
   104 = D00B			kolm3p	=	$D00B		; kolizja pocisku 3 z graczem (O)
   105 = D00C			kolp0p	=	$D00C		; kolizja gracza 0 z innym graczem (O)
   106 = D00D			kolp1p	=	$D00D		; kolizja gracza 1 z innym graczem (O)
   107 = D00E			kolp2p	=	$D00E		; kolizja gracza 2 z innym graczem (O)
   108 = D00F			kolp3p	=	$D00F		; kolizja gracza 3 z innym graczem (O)
   109 = D010			trig0	=	$D010		; stan przycisku joysticka 0 (O)
   110 = D011			trig1	=	$D011		; stan przycisku joysticka 1 (O)
   111 = D013			trig3	=	$D013		; znacznik do³¹czenia cartridge-a (O)
   112 = D014			pal	=	$D014		; znacznik systemu TV (O)
   113
   114 = D01B			gtictl	=	$D01B		; rejestr kontroli uk³adu GTIA
   115 = D01B			gtiactl	=	gtictl
   116
   117 = D01C			vdelay	=	$D01C		; licznik opónienia pionowego P/MG
   118 = D01D			pmcntl	=	$D01D		; rejestr kontroli graczy i pocisków
   119 = D01E			hitclr	=	$D01E		; rejestr kasowania rejestrów kolizji
   120 = D01F			consol	=	$D01F		; rejestr stanu klawiszy konsoli
   121
   122 				* ---------------------------------------------------------------------------------------------
   123 				* ---	POKEY
   124 				* ---------------------------------------------------------------------------------------------
   125
   126 = 0010			irqens	=	$0010		; rejestr-cieñ IRQEN
   127 = 0011			irqstat	=	$0011		; rejestr-cieñ IRQST
   128
   129 = D200			audf1	=	$d200		; czêstotliwoæ pracy generatora 1 (Z)
   130 = D201			audc1	=	$d201		; rejestr kontroli dwiêku generatora 1 (Z)
   131 = D202			audf2	=	$d202		; czêstotliwoæ pracy generatora 2 (Z)
   132 = D203			audc2	=	$d203		; rejestr kontroli dwiêku generatora 2 (Z)
   133 = D204			audf3	=	$d204		; czêstotliwoæ pracy generatora 3 (Z)
   134 = D205			audc3	=	$d205		; rejestr kontroli dwiêku generatora 3 (Z)
   135 = D206			audf4	=	$d206		; czêstotliwoæ pracy generatora 4 (Z)
   136 = D207			audc4	=	$d207		; rejestr kontroli dwiêku generatora 4 (Z)
   137
   138 = D208			audctl	=	$D208		; rejestr kontroli generatorów dwiêku (Z)
   139 = D209			stimer	=	$D209		; rejestr zerowania liczników (Z)
   140 = D209			kbcode	=	$D209		; kod ostatnio naciniêtego klawisza (O)
   141 = D20A			skstres	=	$D20A		; rejestr statusu z³¹cza szeregowego (Z)
   142 = D20A			random	=	$D20A		; rejestr liczby losowej (O)
   143 = D20D			serout	=	$D20D		; szeregowy rejestr wyjciowy (Z)
   144 = D20D			serin	=	$D20D		; szeregowy rejestr wejciowy (O)
   145 = D20E			irqen	=	$D20E		; zezwolenie przerwañ IRQ (Z)
   146 = D20E			irqst	=	$D20E		; status przerwañ IRQ (O)
   147 = D20F			skctl	=	$D20F		; rejestr kontroli z³¹cza szeregowego (Z)
   148 = D20F			skstat	=	$D20F		; rejestr statusu z³¹cza szeregowego (O)
   149
   150 				* ---------------------------------------------------------------------------------------------
   151 				* ---	PIA
   152 				* ---------------------------------------------------------------------------------------------
   153 = D300			porta	=	$D300		; port A uk³adu PIA
   154 = D301			portb	=	$D301		; port B uk³adu PIA
   155 = D302			pactl	=	$D302		; rejestr kontroli portu A
   156 = D303			pbctl	=	$D303		; rejestr kontroli portu B
   157
   158 				* ---------------------------------------------------------------------------------------------
   159 				* ---	ANTIC
   160 				* ---------------------------------------------------------------------------------------------
   161 = D400			dmactl	=	$D400		; rejestr kontroli dostêpu do pamiêci
   162 = D401			chrctl	=	$D401		; rejestr kontroli wywietlania znaków
   163 = D402			dlptr	=	$D402		; adres programu ANTIC-a
   164 = D404			hscrol	=	$D404		; znacznik poziomego przesuwu obrazu
   165 = D405			vscrol	=	$D405		; znacznik pionowego przesuwu obrazu
   166 = D407			pmbase	=	$D407		; adres pamiêci graczy i pocisków
   167 = D409			chbase	=	$D409		; adres zestawu znaków
   168 = D40A			wsync	=	$D40A		; znacznik oczekiwania na synchronizacjê poziom¹
   169 = D40B			vcount	=	$D40B		; licznik linii obrazu
   170 = D40C			lpenh	=	$D40C		; poziome po³o¿enie pióra wietlengo
   171 = D40D			lpenv	=	$D40D		; pionowe po³o¿enie pióra wietlnego
   172 = D40E			nmien	=	$D40E		; rejestr zezwoleñ na przerwania NMI
   173 = D40F			nmist	=	$D40F		; rejestr statusu przerwañ NMI
   174
   175 				* ---------------------------------------------------------------------------------------------
   176 				* ---	OS
   177 				* ---------------------------------------------------------------------------------------------
   178
   179 = 02C4			colpf0s	=	$02C4		; rejestr-cieñ COLPF0
   180 = 02C5			colpf1s	=	$02C5		; rejestr-cieñ COLPF1
   181 = 02C6			colpf2s	=	$02C6		; rejestr-cieñ COLPF2
   182 = 02C7			colpf3s	=	$02C7		; rejestr-cieñ COLPF3
   183 = 02C8			colbaks	=	$02C8		; rejestr-cieñ COLBAK
    15 					
    16 = 1770			MODUL 		equ 6000
    17 = 1F40			MUSICPLAYER	equ 8000
    18
    19 845F					org $a123
    20 A123			COLOR_TABLE_START_NTSC
    21 A123-A145> 26			dta b($26) ; Wlosy
    22 A124 48				dta b($48) ; Odcien jakby skory
    23 A125 44				dta b($44) ; Jezyk i paszcza
    24 A126 26				dta b($26) ; Buty
    25 A127 0A				dta b($0a) ; Prawa dlon
    26 A128 96				dta b($96) ; Spodnie odcien
    27 A129 AA				dta b($aA) ; Koszula
    28 A12A F4				dta b($F4) ; Buty odcien
    29 A12B 48				dta b($48) ; Prawa dlon odcien
    30 A12C 9A				dta b($9A) ; Nogawki
    31 A12D B6				dta b($b6) ; Flaczki na podlodze
    32 A12E 04				dta b($04) ; Pieczara tlo
    33 A12F 0A				dta b($0A) ; Troche twarzy, kasku oraz Tensora
    34 A130 A6				dta b($a6) ; Zielonkawosc jaskini
    35 A131 B6				dta b($b6) ; Czubeczek i baza Tensora
    36 A132 48				dta b($48) ; Cien pod wlosami
    37 A133 AA				dta b($aA) ; Lewy rekaw
    38
    39 A134			COLOR_TABLE_START
    40 A134 16				dta b($16) ; Wlosy
    41 A135 38				dta b($38) ; Odcien jakby skory
    42 A136 34				dta b($34) ; Jezyk i paszcza
    43 A137 16				dta b($16) ; Buty
    44 A138 0A				dta b($0a) ; Prawa dlon
    45 A139 86				dta b($86) ; Spodnie odcien
    46 A13A 9A				dta b($9A) ; Koszula
    47 A13B F4				dta b($F4) ; Buty odcien
    48 A13C 38				dta b($38) ; Prawa dlon odcien
    49 A13D 8A				dta b($8A) ; Nogawki
    50 A13E A6				dta b($A6) ; Flaczki na podlodze
    51 A13F 04				dta b($04) ; Pieczara tlo
    52 A140 0A				dta b($0A) ; Troche twarzy, kasku oraz Tensora
    53 A141 96				dta b($96) ; Zielonkawosc jaskini
    54 A142 A6				dta b($A6) ; Czubeczek i baza Tensora
    55 A143 38				dta b($38) ; Cien pod wlosami
    56 A144 9A				dta b($9A) ; Lewy rekaw
    57
    58 A145			COLOR_TABLE_END
    59 = 0011			COLOR_COUNT equ 	COLOR_TABLE_END - COLOR_TABLE_START
    60 A145 00			ntsc dta(0)
    61
    62 A146				org $f0
    63
    64 = 00F0			fcnt	.ds 2
    65 = 00F2			fadr	.ds 2
    66 = 00F4			fhlp	.ds 2
    67 = 00F6			cloc	.ds 1
    68 = 00F7			regA	.ds 1
    69 = 00F8			regX	.ds 1
    70 = 00F9			regY	.ds 1
    71
    72 = 0028			WIDTH	= 40
    73 = 001E			HEIGHT	= 30
    74
    75 				; ---	BASIC switch OFF
    76 					org $2000\ mva #$ff portb\ rts\ ini $2000
    76 00FA				ORG $2000
    76 2000-2005> A9 FF 8D 01 +  MVA #$FF PORTB
    76 2005 60			 RTS
    76 02E2-02E3> 00 20		 INI $2000
    77
    78 				; ---	MAIN PROGRAM
    79 2006				org $2000
    80 2000-2407> 70 70		ant	dta $70,$70
    81 2002 44 20 20			dta $44,a(scr)
    82 2005 04 84 04 84 84 04 + 	dta $04,$84,$04,$84,$84,$04,$84,$04,$04,$84,$84,$04,$84,$04
    83 2013 04 84 04 04 84 04 + 	dta $04,$84,$04,$04,$84,$04,$84,$84,$04,$04
    84 201D 41 00 20			dta $41,a(ant)
    85
    86 2020 00 01 02 00 00 00 + scr	ins "title_1.src"+0,+80,+25*40
    87
    88 = 2408				.ds 0*40
    89
    90 2408				.ALIGN $0400
    91 2800-47FF> 00 00 00 00 + fnt	ins "title_1.fnt"
    92
    93 					ift USESPRITES
    94 4800				.ALIGN $0800
    95 = 4800			pmg	.ds $0300
    96 					ift FADECHR = 0
    97 4B00				SPRITES
Macro: SPRITES [Source: title_1.asm]
     1 4B00			missiles
     2 4B00-538E> 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
     3 4B10 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
     4 4B20 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
     5 4B30 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
     6 4B40 00 00 00 00 00 01 + 	.he 00 00 00 00 00 01 00 00 02 00 00 00 02 01 00 00
     7 4B50 00 00 00 00 08 00 + 	.he 00 00 00 00 08 00 00 00 00 00 00 00 00 00 00 00
     8 4B60 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 4A 03 83 45 02
     9 4B70 41 01 04 09 01 00 + 	.he 41 01 04 09 01 00 01 00 00 00 00 01 01 00 01 00
    10 4B80 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    11 4B90 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    12 4BA0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    13 4BB0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    14 4BC0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 20
    15 4BD0 10 20 20 00 10 30 + 	.he 10 20 20 00 10 30 02 00 00 00 00 00 00 00 00 00
    16 4BE0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    17 4BF0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    18 4C00			player0
    19 4C00 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    20 4C10 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    21 4C20 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    22 4C30 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    23 4C40 00 00 00 00 12 10 + 	.he 00 00 00 00 12 10 45 08 00 00 00 00 00 00 00 00
    24 4C50 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    25 4C60 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    26 4C70 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    27 4C80 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    28 4C90 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    29 4CA0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    30 4CB0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    31 4CC0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 20 70 E0 D0 A8 54
    32 4CD0 2A 1F 0F 06 00 00 + 	.he 2A 1F 0F 06 00 00 01 03 00 00 00 00 00 00 00 00
    33 4CE0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    34 4CF0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    35 4D00			player1
    36 4D00 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    37 4D10 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    38 4D20 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    39 4D30 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    40 4D40 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01
    41 4D50 04 0C 1C 38 03 07 + 	.he 04 0C 1C 38 03 07 1F 1E 3E 3C 3E 3C 7C FC F8 BE
    42 4D60 3E FC FC D8 F8 F0 + 	.he 3E FC FC D8 F8 F0 E0 F0 F0 00 48 08 A2 10 40 A0
    43 4D70 41 22 11 09 03 C0 + 	.he 41 22 11 09 03 C0 E0 F0 F8 FE FF FF DF EF E2 C0
    44 4D80 C0 C0 C0 80 80 80 + 	.he C0 C0 C0 80 80 80 00 00 00 00 00 00 00 00 00 00
    45 4D90 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    46 4DA0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    47 4DB0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    48 4DC0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    49 4DD0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    50 4DE0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    51 4DF0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    52 4E00			player2
    53 4E00 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    54 4E10 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    55 4E20 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    56 4E30 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    57 4E40 00 00 00 00 00 01 + 	.he 00 00 00 00 00 01 02 1F 00 03 06 04 80 48 28 08
    58 4E50 10 04 0B 04 20 43 + 	.he 10 04 0B 04 20 43 02 29 41 81 01 1C CE EE 7D 72
    59 4E60 8C 60 00 00 80 41 + 	.he 8C 60 00 00 80 41 36 00 00 00 08 14 10 10 18 14
    60 4E70 18 18 1C 18 08 0C + 	.he 18 18 1C 18 08 0C 08 0C 0C 0C 0C 0C 0C 0E 0C 0E
    61 4E80 0E 0C 00 00 00 00 + 	.he 0E 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    62 4E90 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    63 4EA0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    64 4EB0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    65 4EC0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 04 0A 70 A3 CB 55 EA
    66 4ED0 35 58 B0 59 2E 00 + 	.he 35 58 B0 59 2E 00 0A 04 00 00 00 00 00 00 00 00
    67 4EE0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    68 4EF0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    69 4F00			player3
    70 4F00 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    71 4F10 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    72 4F20 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    73 4F30 00 00 00 01 02 00 + 	.he 00 00 00 01 02 00 00 00 00 00 00 00 00 10 10 30
    74 4F40 30 28 2C 3C 3E 66 + 	.he 30 28 2C 3C 3E 66 6F 1C 4D 7F 6C DC DE F8 F8 3C
    75 4F50 7C 4C 4E 8C 3C 24 + 	.he 7C 4C 4E 8C 3C 24 7C 78 28 38 14 18 08 08 06 00
    76 4F60 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 20 00 10 52 3A 3E 7F
    77 4F70 7B 77 3A 18 00 00 + 	.he 7B 77 3A 18 00 00 00 00 00 00 00 00 00 00 00 00
    78 4F80 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    79 4F90 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    80 4FA0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    81 4FB0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    82 4FC0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    83 4FD0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    84 4FE0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    85 4FF0 00 00 00 00 00 00 + 	.he 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Source: title_1.asm
    98 					els
    99 					.ds $500
   100 					eif
   101 					eif
   102
   103 5000			synchro
   104 5000 AD 14 D0				lda PAL
   105 5003 C9 01				cmp #1
   106 5005 D0 05				bne synchr1
   107 5007 A9 91				lda #145	; PAL
   108 5009 4C 0E 50				jmp synchr2
   109 500C A9 78		synchr1 lda #120	; NTSC
   110 500E CD 0B D4		synchr2	cmp VCOUNT
   111 5011 D0 FB				bne synchr2
   112 5013 60					rts
   113
   114 5014			main
   115 				; thanks to mono
   116 5014			detect_ntsc
   117 5014 78					sei
   118 5015 A9 00			  	lda #0
   119 5017 8D 45 A1				sta ntsc
   120 501A AE 0B D4		sync1 	ldx VCOUNT
   121 501D 10 FB		      	bpl sync1
   122 501F 8A			sync2 	txa
   123 5020 AE 0B D4		      	ldx VCOUNT
   124 5023 30 FA		      	bmi sync2
   125
   126 5025 C9 8F		      	cmp #[312+262]/2/2		
   127 5027 B0 10			  	bcs dn_1
   128 5029 EE 45 A1				inc ntsc
   129
   130 502C A0 00				ldy #0
   131 502E B9 23 A1		DNTSC_1	lda COLOR_TABLE_START_NTSC,y
   132 5031 99 34 A1				sta COLOR_TABLE_START,y
   133 5034 C8					iny 
   134 5035 C0 11				cpy #COLOR_COUNT
   135 5037 D0 F5				bne DNTSC_1
   136
   137 5039 58			dn_1  	cli
   138
   139
   140 				; ---	init PMG
   141
   142 503A A9 00			lda #00
   143 503C A2 00			ldx #$00
   144 503E A0 60			ldy #$60
   145 5040 20 00 80			jsr RASTERMUSICTRACKER	;Init
   146 					
   147 					ift USESPRITES
   148 5043 A9 48 8D 07 D4		mva >pmg pmbase		;missiles and players data address
   149 5048 A9 03 8D 1D D0		mva #$03 pmcntl		;enable players and missiles
   150 					eif
   151
   152 504D A5 14 C5 14 F0 FC		lda:cmp:req $14		;wait 1 frame
   153
   154 5053 78				sei			;stop IRQ interrupts
   155 5054 A9 00 8D 0E D4		mva #$00 nmien		;stop NMI interrupts
   156 5059 8D 00 D4			sta dmactl
   157 505C A9 FE 8D 01 D3		mva #$fe portb		;switch off ROM to get 16k more ram
   158
   159 5061 A9 DC 8D FA FF A9 + 	mwa #NMI $fffa		;new NMI handler
   160
   161 506B A9 C0 8D 0E D4		mva #$c0 nmien		;switch on NMI+DLI again
   162
   163 					ift CHANGES		;if label CHANGES defined
   164
   165 5070 AD 10 D0		_lp	lda trig0		; FIRE #0
   166 5073 F0 13			beq stop
   167
   168 5075 AD 11 D0			lda trig1		; FIRE #1
   169 5078 F0 0E			beq stop
   170
   171 507A AD 1F D0			lda consol		; START
   172 507D 29 01			and #1
   173 507F F0 07			beq stop
   174
   175 5081 AD 0F D2			lda skctl
   176 5084 29 04			and #$04
   177 5086 D0 E8			bne _lp			;wait to press any key; here you can put any own routine
   178
   179 					els
   180
   181 				null	jmp DLI.dli1		;CPU is busy here, so no more routines allowed
   182
   183 					eif
   184
   185
   186 5088			stop
   187 5088 20 09 80			jsr RASTERMUSICTRACKER+9 ; Stop music
   188 508B A9 00 8D 1D D0		mva #$00 pmcntl		;PMG disabled
   189 5090 AA				tax
   190 5091 9D 00 D0 E8 D0 FA		sta:rne hposp0,x+
   191
   192 5097 A9 FF 8D 01 D3		mva #$ff portb		;ROM switch on
   193 509C A9 40 8D 0E D4		mva #$40 nmien		;only NMI interrupts, DLI disabled
   194 50A1 58				cli			;IRQ enabled
   195
   196 50A2 60				rts			;return to ... DOS
   197
   198 				; ---	DLI PROGRAM
   199
   200 50A3			.local	DLI
   201
   202 = 50A3				?old_dli = *
   203
   204 					ift !CHANGES
   205
   206 				dli1	lda trig0		; FIRE #0
   207 					beq stop
   208
   209 					lda trig1		; FIRE #1
   210 					beq stop
   211
   212 					lda consol		; START
   213 					and #1
   214 					beq stop
   215
   216 					lda skctl
   217 					and #$04
   218 					beq stop
   219
   220 					lda vcount
   221 					cmp #$02
   222 					bne dli1
   223
   224 					:3 sta wsync
   225
   226 					DLINEW dli12
   227
   228 					eif
   229
   230 50A3			dli_start
   231
   232 50A3			dli12
   233 50A3 85 F7			sta regA
   234
   235 50A5 AD 34 A1		c9	lda COLOR_TABLE_START+0
   236 50A8 8D 0A D4			sta wsync		;line=40
   237 50AB 8D 19 D0			sta color3
   238 50AE				DLINEW DLI.dli2 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 50AE A9 B6 8D E2 52		mva <DLI.DLI2 NMI.dliv
     7 50B3 A5 F7			lda regA
    18 50B5 40				rti
    20 = 50B6				.def ?old_dli = *
Source: title_1.asm
   239
   240 50B6			dli2
   241 50B6 85 F7			sta regA
   242 50B8 A9 2C			lda >fnt+$400*$01
   243 50BA 8D 0A D4			sta wsync		;line=56
   244 50BD 8D 09 D4			sta chbase
   245 50C0				DLINEW dli13 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 50C0 A9 C8 8D E2 52		mva <DLI13 NMI.dliv
     7 50C5 A5 F7			lda regA
    18 50C7 40				rti
    20 = 50C8				.def ?old_dli = *
Source: title_1.asm
   246
   247 50C8			dli13
   248 50C8 85 F7			sta regA
   249
   250 50CA AD 35 A1		c10	lda COLOR_TABLE_START+1
   251 50CD 8D 0A D4			sta wsync		;line=64
   252 50D0 8D 19 D0			sta color3
   253 50D3 AD 36 A1		c11	lda COLOR_TABLE_START+2
   254 50D6 8D 0A D4			sta wsync		;line=65
   255 50D9 8D 14 D0			sta colpm2
   256 50DC 8D 0A D4			sta wsync		;line=66
   257 50DF 8D 0A D4			sta wsync		;line=67
   258 50E2 8D 0A D4			sta wsync		;line=68
   259 50E5 8D 0A D4			sta wsync		;line=69
   260 50E8 8D 0A D4			sta wsync		;line=70
   261 50EB A9 8D		x8	lda #$8D
   262 50ED 8D 0A D4			sta wsync		;line=71
   263 50F0 8D 03 D0			sta hposp3
   264 50F3 8D 0A D4			sta wsync		;line=72
   265 50F6 8D 0A D4			sta wsync		;line=73
   266 50F9 8D 0A D4			sta wsync		;line=74
   267 50FC 8D 0A D4			sta wsync		;line=75
   268 50FF A9 7B		x9	lda #$7B
   269 5101 8D 0A D4			sta wsync		;line=76
   270 5104 8D 01 D0			sta hposp1
   271 5107				DLINEW dli3 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 5107 A9 14 8D E2 52		mva <DLI3 NMI.dliv
     3 510C A9 51 8D E3 52		mva >DLI3 NMI.dliv+1
     7 5111 A5 F7			lda regA
    18 5113 40				rti
    20 = 5114				.def ?old_dli = *
Source: title_1.asm
   272
   273 5114			dli3
   274 5114 85 F7			sta regA
   275 5116 86 F8			stx regX
   276 5118 84 F9			sty regY
   277 511A A9 30			lda >fnt+$400*$02
   278 511C 8D 0A D4			sta wsync		;line=80
   279 511F 8D 09 D4			sta chbase
   280 5122 8D 0A D4			sta wsync		;line=81
   281 5125 A9 01		s3	lda #$01
   282 5127 A2 74		x10	ldx #$74
   283 5129 8D 0A D4			sta wsync		;line=82
   284 512C 8D 09 D0			sta sizep1
   285 512F 8E 01 D0			stx hposp1
   286 5132 8D 0A D4			sta wsync		;line=83
   287 5135 8D 0A D4			sta wsync		;line=84
   288 5138 8D 0A D4			sta wsync		;line=85
   289 513B 8D 0A D4			sta wsync		;line=86
   290 513E A9 6E		x11	lda #$6E
   291 5140 A2 A6		x12	ldx #$A6
   292 5142 AC 37 A1		c12	ldy COLOR_TABLE_START+3
   293 5145 8D 0A D4			sta wsync		;line=87
   294 5148 8D 01 D0			sta hposp1
   295 514B 8E 04 D0			stx hposm0
   296 514E 8C 12 D0			sty colpm0
   297 5151 8D 0A D4			sta wsync		;line=88
   298 5154 A9 46		x13	lda #$46
   299 5156 8D 0A D4			sta wsync		;line=89
   300 5159 8D 05 D0			sta hposm1
   301 515C 8D 0A D4			sta wsync		;line=90
   302 515F 8D 0A D4			sta wsync		;line=91
   303 5162 8D 0A D4			sta wsync		;line=92
   304 5165 A9 00		s4	lda #$00
   305 5167 A2 40		x14	ldx #$40
   306 5169 AC 38 A1		c13	ldy COLOR_TABLE_START+4
   307 516C 8D 0A D4			sta wsync		;line=93
   308 516F 8D 0B D0			sta sizep3
   309 5172 8E 03 D0			stx hposp3
   310 5175 8C 15 D0			sty colpm3
   311 5178 8D 0A D4			sta wsync		;line=94
   312 517B A9 6D		x15	lda #$6D
   313 517D 8D 0A D4			sta wsync		;line=95
   314 5180 8D 01 D0			sta hposp1
   315 5183 AD 39 A1		c14	lda COLOR_TABLE_START+5
   316 5186 8D 0A D4			sta wsync		;line=96
   317 5189 8D 19 D0			sta color3
   318 518C AD 3A A1		c15	lda COLOR_TABLE_START+6
   319 518F A2 A2		x16	ldx #$A2
   320 5191 AC 3B A1		c16	ldy COLOR_TABLE_START+7
   321 5194 8D 0A D4			sta wsync		;line=97
   322 5197 8D 17 D0			sta color1
   323 519A 8E 02 D0			stx hposp2
   324 519D 8C 14 D0			sty colpm2
   325 51A0 A9 00		s5	lda #$00
   326 51A2 A2 3E		x17	ldx #$3E
   327 51A4 AC 3C A1		c17	ldy COLOR_TABLE_START+8
   328 51A7 8D 0A D4			sta wsync		;line=98
   329 51AA 8D 09 D0			sta sizep1
   330 51AD 8E 01 D0			stx hposp1
   331 51B0 8C 13 D0			sty colpm1
   332 51B3				DLINEW dli4 1 1 1
Macro: DLINEW [Source: title_1.asm]
     1 51B3 A9 BF 8D E2 52		mva <DLI4 NMI.dliv
     7 51B8 A5 F7			lda regA
    11 51BA A6 F8			ldx regX
    15 51BC A4 F9			ldy regY
    18 51BE 40				rti
    20 = 51BF				.def ?old_dli = *
Source: title_1.asm
   333
   334 51BF			dli4
   335 51BF 85 F7			sta regA
   336 51C1 86 F8			stx regX
   337 51C3 84 F9			sty regY
   338 51C5 A9 34			lda >fnt+$400*$03
   339 51C7 8D 0A D4			sta wsync		;line=104
   340 51CA 8D 09 D4			sta chbase
   341 51CD 8D 0A D4			sta wsync		;line=105
   342 51D0 8D 0A D4			sta wsync		;line=106
   343 51D3 8D 0A D4			sta wsync		;line=107
   344 51D6 8D 0A D4			sta wsync		;line=108
   345 51D9 A9 03		s6	lda #$03
   346 51DB A2 88		x18	ldx #$88
   347 51DD AC 3D A1		c18	ldy COLOR_TABLE_START+9
   348 51E0 8D 0A D4			sta wsync		;line=109
   349 51E3 8D 09 D0			sta sizep1
   350 51E6 8E 01 D0			stx hposp1
   351 51E9 8C 13 D0			sty colpm1
   352 51EC				DLINEW dli14 1 1 1
Macro: DLINEW [Source: title_1.asm]
     1 51EC A9 F8 8D E2 52		mva <DLI14 NMI.dliv
     7 51F1 A5 F7			lda regA
    11 51F3 A6 F8			ldx regX
    15 51F5 A4 F9			ldy regY
    18 51F7 40				rti
    20 = 51F8				.def ?old_dli = *
Source: title_1.asm
   353
   354 51F8			dli14
   355 51F8 85 F7			sta regA
   356
   357 51FA A9 86		x19	lda #$86
   358 51FC 8D 0A D4			sta wsync		;line=112
   359 51FF 8D 01 D0			sta hposp1
   360 5202 A9 A7		x20	lda #$A7
   361 5204 8D 0A D4			sta wsync		;line=113
   362 5207 8D 04 D0			sta hposm0
   363 520A A9 83		x21	lda #$83
   364 520C 8D 0A D4			sta wsync		;line=114
   365 520F 8D 01 D0			sta hposp1
   366 5212 8D 0A D4			sta wsync		;line=115
   367 5215 8D 0A D4			sta wsync		;line=116
   368 5218 A9 81		x22	lda #$81
   369 521A 8D 0A D4			sta wsync		;line=117
   370 521D 8D 01 D0			sta hposp1
   371 5220				DLINEW dli5 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 5220 A9 2D 8D E2 52		mva <DLI5 NMI.dliv
     3 5225 A9 52 8D E3 52		mva >DLI5 NMI.dliv+1
     7 522A A5 F7			lda regA
    18 522C 40				rti
    20 = 522D				.def ?old_dli = *
Source: title_1.asm
   372
   373 522D			dli5
   374 522D 85 F7			sta regA
   375 522F A9 38			lda >fnt+$400*$04
   376 5231 8D 0A D4			sta wsync		;line=128
   377 5234 8D 09 D4			sta chbase
   378 5237 8D 0A D4			sta wsync		;line=129
   379 523A 8D 0A D4			sta wsync		;line=130
   380 523D 8D 0A D4			sta wsync		;line=131
   381 5240 8D 0A D4			sta wsync		;line=132
   382 5243 8D 0A D4			sta wsync		;line=133
   383 5246 AD 3D A1		c19	lda COLOR_TABLE_START+9
   384 5249 8D 0A D4			sta wsync		;line=134
   385 524C 8D 17 D0			sta color1
   386 524F				DLINEW dli6 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 524F A9 57 8D E2 52		mva <DLI6 NMI.dliv
     7 5254 A5 F7			lda regA
    18 5256 40				rti
    20 = 5257				.def ?old_dli = *
Source: title_1.asm
   387
   388 5257			dli6
   389 5257 85 F7			sta regA
   390 5259 A9 3C			lda >fnt+$400*$05
   391 525B 8D 0A D4			sta wsync		;line=152
   392 525E 8D 09 D4			sta chbase
   393 5261 8D 0A D4			sta wsync		;line=153
   394 5264 8D 0A D4			sta wsync		;line=154
   395 5267 8D 0A D4			sta wsync		;line=155
   396 526A A9 91		x23	lda #$91
   397 526C 8D 0A D4			sta wsync		;line=156
   398 526F 8D 00 D0			sta hposp0
   399 5272				DLINEW dli7 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 5272 A9 7A 8D E2 52		mva <DLI7 NMI.dliv
     7 5277 A5 F7			lda regA
    18 5279 40				rti
    20 = 527A				.def ?old_dli = *
Source: title_1.asm
   400
   401 527A			dli7
   402 527A 85 F7			sta regA
   403 527C A9 40			lda >fnt+$400*$06
   404 527E 8D 0A D4			sta wsync		;line=176
   405 5281 8D 09 D4			sta chbase
   406 5284				DLINEW dli15 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 5284 A9 8C 8D E2 52		mva <DLI15 NMI.dliv
     7 5289 A5 F7			lda regA
    18 528B 40				rti
    20 = 528C				.def ?old_dli = *
Source: title_1.asm
   407
   408 528C			dli15
   409 528C 85 F7			sta regA
   410
   411 528E 8D 0A D4			sta wsync		;line=192
   412 5291 A9 8E		x24	lda #$8E
   413 5293 8D 0A D4			sta wsync		;line=193
   414 5296 8D 02 D0			sta hposp2
   415 5299 8D 0A D4			sta wsync		;line=194
   416 529C 8D 0A D4			sta wsync		;line=195
   417 529F AD 3E A1		c20	lda COLOR_TABLE_START+10
   418 52A2 8D 0A D4			sta wsync		;line=196
   419 52A5 8D 19 D0			sta color3
   420 52A8 A9 8F		x25	lda #$8F
   421 52AA 8D 0A D4			sta wsync		;line=197
   422 52AD 8D 02 D0			sta hposp2
   423 52B0				DLINEW dli8 1 0 0
Macro: DLINEW [Source: title_1.asm]
     1 52B0 A9 B8 8D E2 52		mva <DLI8 NMI.dliv
     7 52B5 A5 F7			lda regA
    18 52B7 40				rti
    20 = 52B8				.def ?old_dli = *
Source: title_1.asm
   424
   425 52B8			dli8
   426 52B8 85 F7			sta regA
   427 52BA 86 F8			stx regX
   428 52BC A9 44			lda >fnt+$400*$07
   429 52BE A2 99		x26	ldx #$99
   430 52C0 8D 0A D4			sta wsync		;line=200
   431 52C3 8D 09 D4			sta chbase
   432 52C6 8E 04 D0			stx hposm0
   433 52C9 A9 99		x27	lda #$99
   434 52CB 8D 0A D4			sta wsync		;line=201
   435 52CE 8D 06 D0			sta hposm2
   436 52D1 A9 91		x28	lda #$91
   437 52D3 8D 0A D4			sta wsync		;line=202
   438 52D6 8D 02 D0			sta hposp2
   439 52D9 A5 F7			lda regA
   440 52DB 40				rti
   441
   442
   443 				.endl
   444
   445 				; ---
   446
   447 = 0001			CHANGES = 1
   448 = 0000			FADECHR	= 0
   449
   450 = 007F			SCHR	= 127
   451
   452 				; ---
   453
   454 52DC			.proc	NMI
   455
   456 52DC 2C 0F D4			bit nmist
   457 52DF 10 03			bpl VBL
   458
   459 52E1 4C A3 50			jmp DLI.dli_start
   460 = 52E2			dliv	equ *-2
   461
   462 52E4			VBL
   463 52E4 85 F7			sta regA
   464 52E6 86 F8			stx regX
   465 52E8 84 F9			sty regY
   466
   467 52EA 8D 0F D4			sta nmist		;reset NMI flag
   468
   469 52ED A9 00 8D 02 D4 A9 + 	mwa #ant dlptr		;ANTIC address program
   470
   471 52F7 A9 3E 8D 00 D4		mva #@dmactl(standard|dma|lineX1|players|missiles) dmactl	;set new screen width
   472
   473 52FC E6 F6			inc cloc		;little timer
   474
   475 				; Initial values
   476
   477 52FE A9 28			lda >fnt+$400*$00
   478 5300 8D 09 D4			sta chbase
   479 5303 A9 00		c0	lda #$00
   480 5305 8D 1A D0			sta colbak
   481 5308 8D 0C D0			sta sizem
   482 530B 8D 08 D0			sta sizep0
   483 530E 8D 09 D0			sta sizep1
   484 5311 8D 0A D0			sta sizep2
   485
   486 5314 AD 3F A1		c1	lda COLOR_TABLE_START+11
   487 5317 8D 16 D0			sta color0
   488 531A AD 40 A1		c2	lda COLOR_TABLE_START+12
   489 531D 8D 17 D0			sta color1
   490 5320 AD 41 A1		c3	lda COLOR_TABLE_START+13
   491 5323 8D 18 D0			sta color2
   492 5326 AD 42 A1		c4	lda COLOR_TABLE_START+14
   493 5329 8D 19 D0			sta color3
   494 532C A9 02			lda #$02
   495 532E 8D 01 D4			sta chrctl
   496 5331 A9 04			lda #$04
   497 5333 8D 1B D0			sta gtictl
   498 5336 A9 97		x0	lda #$97
   499 5338 8D 06 D0			sta hposm2
   500 533B AD 43 A1		c5	lda COLOR_TABLE_START+15
   501 533E 8D 14 D0			sta colpm2
   502 5341 A9 01		s1	lda #$01
   503 5343 8D 0B D0			sta sizep3
   504 5346 A9 88		x1	lda #$88
   505 5348 8D 00 D0			sta hposp0
   506 534B A9 7F		x2	lda #$7F
   507 534D 8D 01 D0			sta hposp1
   508 5350 A9 65		x3	lda #$65
   509 5352 8D 02 D0			sta hposp2
   510 5355 A9 91		x4	lda #$91
   511 5357 8D 03 D0			sta hposp3
   512 535A A9 86		x5	lda #$86
   513 535C 8D 04 D0			sta hposm0
   514 535F A9 83		x6	lda #$83
   515 5361 8D 05 D0			sta hposm1
   516 5364 A9 3F		x7	lda #$3F
   517 5366 8D 07 D0			sta hposm3
   518 5369 AD 43 A1		c6	lda COLOR_TABLE_START+15
   519 536C 8D 12 D0			sta colpm0
   520 536F AD 44 A1		c7	lda COLOR_TABLE_START+16
   521 5372 8D 13 D0			sta colpm1
   522 5375 AD 42 A1		c8	lda COLOR_TABLE_START+14
   523 5378 8D 15 D0			sta colpm3
   524
   525 					
   526 537B A9 A3 8D E2 52 A9 + 	mwa #DLI.dli_start dliv	;set the first address of DLI interrupt
   527
   528 				;this area is for yours routines
   529 5385 20 03 80			jsr RASTERMUSICTRACKER+3
   530
   531 5388			quit
   532 5388 A5 F7			lda regA
   533 538A A6 F8			ldx regX
   534 538C A4 F9			ldy regY
   535 538E 40				rti
   536
   537 				.endp
   538
   539 				; ---
   540 02E2-02E3> 14 50			ini main
   541 				; ---
   542
